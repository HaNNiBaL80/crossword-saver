<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
<title>Cappuccino: AppKit/CPWindow/CPWindow.j Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.5.9-20090622 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false);
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" 
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange()"/>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>AppKit/CPWindow/CPWindow.j</h1><a href="_c_p_window_8j.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * CPWindow.j</span>
<a name="l00003"></a>00003 <span class="comment"> * AppKit</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Created by Francisco Tolmasky.</span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright 2008, 280 North, Inc.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
<a name="l00009"></a>00009 <span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="l00010"></a>00010 <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l00011"></a>00011 <span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span>
<a name="l00016"></a>00016 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment"> * License along with this library; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_counted_set.html">CPCountedSet</a>.j&gt;
<a name="l00024"></a>00024 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_notification_center.html">CPNotificationCenter</a>.j&gt;
<a name="l00025"></a>00025 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_undo_manager.html">CPUndoManager</a>.j&gt;
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 @<span class="keyword">import</span> <span class="stringliteral">&quot;CGGeometry.j&quot;</span>
<a name="l00028"></a>00028 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPAnimation.j&quot;</span>
<a name="l00029"></a>00029 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPResponder.j&quot;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;../Platform/Platform.h&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;../Platform/DOM/CPDOMDisplayServer.h&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;../CoreGraphics/CGGeometry.h&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">/*</span>
<a name="l00038"></a>00038 <span class="comment">    Borderless window mask option.</span>
<a name="l00039"></a>00039 <span class="comment">    @global</span>
<a name="l00040"></a>00040 <span class="comment">    @class CPWindow</span>
<a name="l00041"></a>00041 <span class="comment">*/</span>
<a name="l00042"></a><a class="code" href="_c_p_window_8j.html#afe0620fbd4de9a3c50bfb818ecc35d66">00042</a> <a class="code" href="_c_p_window_8j.html#afe0620fbd4de9a3c50bfb818ecc35d66">CPBorderlessWindowMask</a>          = 0;
<a name="l00043"></a>00043 <span class="comment">/*</span>
<a name="l00044"></a>00044 <span class="comment">    Titled window mask option.</span>
<a name="l00045"></a>00045 <span class="comment">    @global</span>
<a name="l00046"></a>00046 <span class="comment">    @class CPWindow</span>
<a name="l00047"></a>00047 <span class="comment">*/</span>
<a name="l00048"></a><a class="code" href="_c_p_window_8j.html#a92c73c5656c71cb11b666a223cce8021">00048</a> <a class="code" href="_c_p_window_8j.html#a92c73c5656c71cb11b666a223cce8021">CPTitledWindowMask</a>              = 1 &lt;&lt; 0;
<a name="l00049"></a>00049 <span class="comment">/*</span>
<a name="l00050"></a>00050 <span class="comment">    Closeable window mask option.</span>
<a name="l00051"></a>00051 <span class="comment">    @global</span>
<a name="l00052"></a>00052 <span class="comment">    @class CPWindow</span>
<a name="l00053"></a>00053 <span class="comment">*/</span>
<a name="l00054"></a><a class="code" href="_c_p_window_8j.html#a023fc2836418fce3604d586d875d2506">00054</a> <a class="code" href="_c_p_window_8j.html#a023fc2836418fce3604d586d875d2506">CPClosableWindowMask</a>            = 1 &lt;&lt; 1;
<a name="l00055"></a>00055 <span class="comment">/*</span>
<a name="l00056"></a>00056 <span class="comment">    Miniaturizabe window mask option.</span>
<a name="l00057"></a>00057 <span class="comment">    @global</span>
<a name="l00058"></a>00058 <span class="comment">    @class CPWindow</span>
<a name="l00059"></a>00059 <span class="comment">*/</span>
<a name="l00060"></a><a class="code" href="_c_p_window_8j.html#ab4bbfb463e32bdd316c00412cccab509">00060</a> <a class="code" href="_c_p_window_8j.html#ab4bbfb463e32bdd316c00412cccab509">CPMiniaturizableWindowMask</a>      = 1 &lt;&lt; 2;
<a name="l00061"></a>00061 <span class="comment">/*</span>
<a name="l00062"></a>00062 <span class="comment">    Resizable window mask option.</span>
<a name="l00063"></a>00063 <span class="comment">    @global</span>
<a name="l00064"></a>00064 <span class="comment">    @class CPWindow</span>
<a name="l00065"></a>00065 <span class="comment">*/</span>
<a name="l00066"></a><a class="code" href="_c_p_window_8j.html#ae2c737a199d2ec0ea9c8547aae2d0a18">00066</a> <a class="code" href="_c_p_window_8j.html#ae2c737a199d2ec0ea9c8547aae2d0a18">CPResizableWindowMask</a>           = 1 &lt;&lt; 3;
<a name="l00067"></a>00067 <span class="comment">/*</span>
<a name="l00068"></a>00068 <span class="comment">    Textured window mask option.</span>
<a name="l00069"></a>00069 <span class="comment">    @global</span>
<a name="l00070"></a>00070 <span class="comment">    @class CPWindow</span>
<a name="l00071"></a>00071 <span class="comment">*/</span>
<a name="l00072"></a><a class="code" href="_c_p_window_8j.html#ae156c52ff5596e85b50900c559268fe1">00072</a> <a class="code" href="_c_p_window_8j.html#ae156c52ff5596e85b50900c559268fe1">CPTexturedBackgroundWindowMask</a>  = 1 &lt;&lt; 8;
<a name="l00073"></a>00073 <span class="comment">/*</span>
<a name="l00074"></a>00074 <span class="comment">    @global</span>
<a name="l00075"></a>00075 <span class="comment">    @class CPWindow</span>
<a name="l00076"></a>00076 <span class="comment">*/</span>
<a name="l00077"></a><a class="code" href="_c_p_window_8j.html#ab9cb38d9cbdffe2bab2f10a4688545bd">00077</a> <a class="code" href="_c_p_window_8j.html#ab9cb38d9cbdffe2bab2f10a4688545bd">CPBorderlessBridgeWindowMask</a>    = 1 &lt;&lt; 20;
<a name="l00078"></a>00078 <span class="comment">/*</span>
<a name="l00079"></a>00079 <span class="comment">    @global</span>
<a name="l00080"></a>00080 <span class="comment">    @class CPWindow</span>
<a name="l00081"></a>00081 <span class="comment">*/</span>
<a name="l00082"></a><a class="code" href="_c_p_window_8j.html#a550358819a66f387034d69aef39cc480">00082</a> <a class="code" href="_c_p_window_8j.html#a550358819a66f387034d69aef39cc480">CPHUDBackgroundWindowMask</a>       = 1 &lt;&lt; 21;
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="_c_p_window_8j.html#a556155bbdc19382299b5ef083560284b">00084</a> <a class="code" href="_c_p_window_8j.html#a556155bbdc19382299b5ef083560284b">CPWindowNotSizable</a>              = 0;
<a name="l00085"></a><a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">00085</a> <a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">CPWindowMinXMargin</a>              = 1;
<a name="l00086"></a><a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">00086</a> <a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">CPWindowWidthSizable</a>            = 2;
<a name="l00087"></a><a class="code" href="_c_p_window_8j.html#aa334d7b21d635b43f2e0a3ed993c19dd">00087</a> <a class="code" href="_c_p_window_8j.html#aa334d7b21d635b43f2e0a3ed993c19dd">CPWindowMaxXMargin</a>              = 4;
<a name="l00088"></a><a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">00088</a> <a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">CPWindowMinYMargin</a>              = 8;
<a name="l00089"></a><a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">00089</a> <a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">CPWindowHeightSizable</a>           = 16;
<a name="l00090"></a><a class="code" href="_c_p_window_8j.html#a46ec4bd30fada9b12a2cc412b40e7f07">00090</a> <a class="code" href="_c_p_window_8j.html#a46ec4bd30fada9b12a2cc412b40e7f07">CPWindowMaxYMargin</a>              = 32;
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="_c_p_window_8j.html#a68f8f77265c354bf1b55367ffe54c55a">00092</a> <a class="code" href="_c_p_window_8j.html#a68f8f77265c354bf1b55367ffe54c55a">CPBackgroundWindowLevel</a>         = -1;
<a name="l00093"></a>00093 <span class="comment">/*</span>
<a name="l00094"></a>00094 <span class="comment">    Default level for windows</span>
<a name="l00095"></a>00095 <span class="comment">    @group CPWindowLevel</span>
<a name="l00096"></a>00096 <span class="comment">    @global</span>
<a name="l00097"></a>00097 <span class="comment">*/</span>
<a name="l00098"></a><a class="code" href="_c_p_window_8j.html#af8c6804a600c65ea9e35419a2b807bd2">00098</a> <a class="code" href="_c_p_window_8j.html#af8c6804a600c65ea9e35419a2b807bd2">CPNormalWindowLevel</a>             = 4;
<a name="l00099"></a>00099 <span class="comment">/*</span>
<a name="l00100"></a>00100 <span class="comment">    Floating palette type window</span>
<a name="l00101"></a>00101 <span class="comment">    @group CPWindowLevel</span>
<a name="l00102"></a>00102 <span class="comment">    @global</span>
<a name="l00103"></a>00103 <span class="comment">*/</span>
<a name="l00104"></a><a class="code" href="_c_p_window_8j.html#a4cb5a0c60fcdbd75361768248b326748">00104</a> <a class="code" href="_c_p_window_8j.html#a4cb5a0c60fcdbd75361768248b326748">CPFloatingWindowLevel</a>           = 5;
<a name="l00105"></a>00105 <span class="comment">/*</span>
<a name="l00106"></a>00106 <span class="comment">    Submenu type window</span>
<a name="l00107"></a>00107 <span class="comment">    @group CPWindowLevel</span>
<a name="l00108"></a>00108 <span class="comment">    @global</span>
<a name="l00109"></a>00109 <span class="comment">*/</span>
<a name="l00110"></a><a class="code" href="_c_p_window_8j.html#a46e6fa028d8a9216dc3e5d5543a27b25">00110</a> <a class="code" href="_c_p_window_8j.html#a46e6fa028d8a9216dc3e5d5543a27b25">CPSubmenuWindowLevel</a>            = 6;
<a name="l00111"></a>00111 <span class="comment">/*</span>
<a name="l00112"></a>00112 <span class="comment">    For a torn-off menu</span>
<a name="l00113"></a>00113 <span class="comment">    @group CPWindowLevel</span>
<a name="l00114"></a>00114 <span class="comment">    @global</span>
<a name="l00115"></a>00115 <span class="comment">*/</span>
<a name="l00116"></a><a class="code" href="_c_p_window_8j.html#a01620b795ed6bf08f4e7f0eb74f28226">00116</a> <a class="code" href="_c_p_window_8j.html#a01620b795ed6bf08f4e7f0eb74f28226">CPTornOffMenuWindowLevel</a>        = 6;
<a name="l00117"></a>00117 <span class="comment">/*</span>
<a name="l00118"></a>00118 <span class="comment">    For the application&apos;s main menu</span>
<a name="l00119"></a>00119 <span class="comment">    @group CPWindowLevel</span>
<a name="l00120"></a>00120 <span class="comment">    @global</span>
<a name="l00121"></a>00121 <span class="comment">*/</span>
<a name="l00122"></a><a class="code" href="_c_p_window_8j.html#a8d39ce99d5f37a67647c5d9367e3f364">00122</a> <a class="code" href="_c_p_window_8j.html#a8d39ce99d5f37a67647c5d9367e3f364">CPMainMenuWindowLevel</a>           = 8;
<a name="l00123"></a>00123 <span class="comment">/*</span>
<a name="l00124"></a>00124 <span class="comment">    Status window level</span>
<a name="l00125"></a>00125 <span class="comment">    @group CPWindowLevel</span>
<a name="l00126"></a>00126 <span class="comment">    @global</span>
<a name="l00127"></a>00127 <span class="comment">*/</span>
<a name="l00128"></a><a class="code" href="_c_p_window_8j.html#a1dfc36bdc9611885eb23d532e022c27f">00128</a> <a class="code" href="_c_p_window_8j.html#a1dfc36bdc9611885eb23d532e022c27f">CPStatusWindowLevel</a>             = 9;
<a name="l00129"></a>00129 <span class="comment">/*</span>
<a name="l00130"></a>00130 <span class="comment">    Level for a modal panel</span>
<a name="l00131"></a>00131 <span class="comment">    @group CPWindowLevel</span>
<a name="l00132"></a>00132 <span class="comment">    @global</span>
<a name="l00133"></a>00133 <span class="comment">*/</span>
<a name="l00134"></a><a class="code" href="_c_p_window_8j.html#a4dbf5de3216100779b5cbad2a78bc916">00134</a> <a class="code" href="_c_p_window_8j.html#a4dbf5de3216100779b5cbad2a78bc916">CPModalPanelWindowLevel</a>         = 10;
<a name="l00135"></a>00135 <span class="comment">/*</span>
<a name="l00136"></a>00136 <span class="comment">    Level for a pop up menu</span>
<a name="l00137"></a>00137 <span class="comment">    @group CPWindowLevel</span>
<a name="l00138"></a>00138 <span class="comment">    @global</span>
<a name="l00139"></a>00139 <span class="comment">*/</span>
<a name="l00140"></a><a class="code" href="_c_p_window_8j.html#ae910f11b4d4d301f08eef61e5f2732ea">00140</a> <a class="code" href="_c_p_window_8j.html#ae910f11b4d4d301f08eef61e5f2732ea">CPPopUpMenuWindowLevel</a>          = 11;
<a name="l00141"></a>00141 <span class="comment">/*</span>
<a name="l00142"></a>00142 <span class="comment">    Level for a window being dragged</span>
<a name="l00143"></a>00143 <span class="comment">    @group CPWindowLevel</span>
<a name="l00144"></a>00144 <span class="comment">    @global</span>
<a name="l00145"></a>00145 <span class="comment">*/</span>
<a name="l00146"></a><a class="code" href="_c_p_window_8j.html#a3018c94066c61cc16967f8807a5d3632">00146</a> <a class="code" href="_c_p_window_8j.html#a3018c94066c61cc16967f8807a5d3632">CPDraggingWindowLevel</a>           = 12;
<a name="l00147"></a>00147 <span class="comment">/*</span>
<a name="l00148"></a>00148 <span class="comment">    Level for the screens saver</span>
<a name="l00149"></a>00149 <span class="comment">    @group CPWindowLevel</span>
<a name="l00150"></a>00150 <span class="comment">    @global</span>
<a name="l00151"></a>00151 <span class="comment">*/</span>
<a name="l00152"></a><a class="code" href="_c_p_window_8j.html#a072b901310711ca455fb39ba5c22ad03">00152</a> <a class="code" href="_c_p_window_8j.html#a072b901310711ca455fb39ba5c22ad03">CPScreenSaverWindowLevel</a>        = 13;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="comment">/*</span>
<a name="l00155"></a>00155 <span class="comment">    The receiver is removed from the screen list and hidden.</span>
<a name="l00156"></a>00156 <span class="comment">    @global</span>
<a name="l00157"></a>00157 <span class="comment">    @class CPWindowOrderingMode</span>
<a name="l00158"></a>00158 <span class="comment">*/</span>
<a name="l00159"></a><a class="code" href="_c_p_window_8j.html#a4eeba0f56fd2d0fd8239c14d4fb86029">00159</a> <a class="code" href="_c_p_window_8j.html#a4eeba0f56fd2d0fd8239c14d4fb86029">CPWindowOut</a>                     = 0;
<a name="l00160"></a>00160 <span class="comment">/*</span>
<a name="l00161"></a>00161 <span class="comment">    The receiver is placed directly in front of the window specified.</span>
<a name="l00162"></a>00162 <span class="comment">    @global</span>
<a name="l00163"></a>00163 <span class="comment">    @class CPWindowOrderingMode</span>
<a name="l00164"></a>00164 <span class="comment">*/</span>
<a name="l00165"></a><a class="code" href="_c_p_window_8j.html#a32733797329818bbb85b9838bbf0fa26">00165</a> <a class="code" href="_c_p_window_8j.html#a32733797329818bbb85b9838bbf0fa26">CPWindowAbove</a>                   = 1;
<a name="l00166"></a>00166 <span class="comment">/*</span>
<a name="l00167"></a>00167 <span class="comment">    The receiver is placed directly behind the window specified.</span>
<a name="l00168"></a>00168 <span class="comment">    @global</span>
<a name="l00169"></a>00169 <span class="comment">    @class CPWindowOrderingMode</span>
<a name="l00170"></a>00170 <span class="comment">*/</span>
<a name="l00171"></a><a class="code" href="_c_p_window_8j.html#a1335df5162b142d7648d2c2ac3d85e37">00171</a> <a class="code" href="_c_p_window_8j.html#a1335df5162b142d7648d2c2ac3d85e37">CPWindowBelow</a>                   = 2;
<a name="l00172"></a>00172 
<a name="l00173"></a><a class="code" href="_c_p_window_8j.html#a735ba3c488f8ed97989326775e3e6212">00173</a> <a class="code" href="_c_p_window_8j.html#a735ba3c488f8ed97989326775e3e6212">CPWindowWillCloseNotification</a>       = <span class="stringliteral">@&quot;CPWindowWillCloseNotification&quot;</span>;
<a name="l00174"></a><a class="code" href="_c_p_window_8j.html#a1f86d11c0903bf469a30c5c739fefa00">00174</a> <a class="code" href="_c_p_window_8j.html#a1f86d11c0903bf469a30c5c739fefa00">CPWindowDidBecomeMainNotification</a>   = <span class="stringliteral">@&quot;CPWindowDidBecomeMainNotification&quot;</span>;
<a name="l00175"></a><a class="code" href="_c_p_window_8j.html#aac3a49b86a2a33863f579d092caec66d">00175</a> <a class="code" href="_c_p_window_8j.html#aac3a49b86a2a33863f579d092caec66d">CPWindowDidResignMainNotification</a>   = <span class="stringliteral">@&quot;CPWindowDidResignMainNotification&quot;</span>;
<a name="l00176"></a><a class="code" href="_c_p_window_8j.html#ab9e5d430bf9a3ca191d537acba2f5848">00176</a> <a class="code" href="_c_p_window_8j.html#ab9e5d430bf9a3ca191d537acba2f5848">CPWindowDidMoveNotification</a>         = <span class="stringliteral">@&quot;CPWindowDidMoveNotification&quot;</span>;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="_c_p_window_8j.html#aa42ad6b1a46744bb41057135d82e2794">00179</a> var <a class="code" href="_c_p_window_8j.html#aa42ad6b1a46744bb41057135d82e2794">SHADOW_MARGIN_LEFT</a>      = 20.0,
<a name="l00180"></a><a class="code" href="_c_p_window_8j.html#af4a32c7f1961957237011c6b4c8b5224">00180</a>     <a class="code" href="_c_p_window_8j.html#af4a32c7f1961957237011c6b4c8b5224">SHADOW_MARGIN_RIGHT</a>     = 19.0,
<a name="l00181"></a><a class="code" href="_c_p_window_8j.html#acd7267d5eb2d409f053b7c21271978d0">00181</a>     <a class="code" href="_c_p_window_8j.html#acd7267d5eb2d409f053b7c21271978d0">SHADOW_MARGIN_TOP</a>       = 10.0,
<a name="l00182"></a><a class="code" href="_c_p_window_8j.html#a30d79bcfce90679ea6720242c787a2a0">00182</a>     <a class="code" href="_c_p_window_8j.html#a30d79bcfce90679ea6720242c787a2a0">SHADOW_MARGIN_BOTTOM</a>    = 10.0,
<a name="l00183"></a><a class="code" href="_c_p_window_8j.html#ae410937f407d814e4a06b902dc29001a">00183</a>     <a class="code" href="_c_p_window_8j.html#ae410937f407d814e4a06b902dc29001a">SHADOW_DISTANCE</a>         = 5.0,
<a name="l00184"></a>00184     
<a name="l00185"></a>00185     _CPWindowShadowColor    = nil;
<a name="l00186"></a>00186     
<a name="l00187"></a><a class="code" href="_c_p_window_8j.html#a51cefe6c4b9ce4b6f5f00509636cc76b">00187</a> var <a class="code" href="_c_p_window_8j.html#a51cefe6c4b9ce4b6f5f00509636cc76b">CPWindowSaveImage</a>       = nil,
<a name="l00188"></a><a class="code" href="_c_p_window_8j.html#a1cedf05cfa18440686df5fd4e2d62e74">00188</a>     <a class="code" href="_c_p_window_8j.html#a1cedf05cfa18440686df5fd4e2d62e74">CPWindowSavingImage</a>     = nil;
<a name="l00189"></a>00189 
<a name="l00236"></a><a class="code" href="class_c_p_window.html">00236</a> <span class="keyword">@implementation </span><a class="code" href="class_c_p_window.html">CPWindow</a> : <a class="code" href="class_c_p_responder.html">CPResponder</a>
<a name="l00237"></a>00237 {
<a name="l00238"></a>00238     <span class="keywordtype">int</span>                         _windowNumber;
<a name="l00239"></a>00239     <span class="keywordtype">unsigned</span>                    _styleMask;
<a name="l00240"></a>00240     CGRect                      _frame;
<a name="l00241"></a>00241     <span class="keywordtype">int</span>                         _level;
<a name="l00242"></a>00242     BOOL                        _isVisible;
<a name="l00243"></a>00243     BOOL                        _isAnimating;
<a name="l00244"></a>00244     BOOL                        _hasShadow;
<a name="l00245"></a>00245     BOOL                        _isMovableByWindowBackground;
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     BOOL                        _isDocumentEdited;
<a name="l00248"></a>00248     BOOL                        _isDocumentSaving;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <a class="code" href="class_c_p_image_view.html">CPImageView</a>                 _shadowView;
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <a class="code" href="class_c_p_view.html">CPView</a>                      _windowView;
<a name="l00253"></a>00253     <a class="code" href="class_c_p_view.html">CPView</a>                      _contentView;
<a name="l00254"></a>00254     <a class="code" href="class_c_p_view.html">CPView</a>                      _toolbarView;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256     <a class="code" href="class_c_p_view.html">CPView</a>                      _mouseOverView;
<a name="l00257"></a>00257     <a class="code" href="class_c_p_view.html">CPView</a>                      _leftMouseDownView;
<a name="l00258"></a>00258     <a class="code" href="class_c_p_view.html">CPView</a>                      _rightMouseDownView;
<a name="l00259"></a>00259 
<a name="l00260"></a>00260     <a class="code" href="class_c_p_toolbar.html">CPToolbar</a>                   _toolbar;
<a name="l00261"></a>00261     <a class="code" href="class_c_p_responder.html">CPResponder</a>                 _firstResponder;
<a name="l00262"></a>00262     <a class="code" href="class_c_p_responder.html">CPResponder</a>                 _initialFirstResponder;
<a name="l00263"></a>00263     <span class="keywordtype">id</span>                          _delegate;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <a class="code" href="class_c_p_string.html">CPString</a>                    _title;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     BOOL                        _acceptsMouseMovedEvents;
<a name="l00268"></a>00268     BOOL                        _ignoresMouseEvents;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270     <a class="code" href="class_c_p_window_controller.html">CPWindowController</a>          _windowController;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     CGSize                      _minSize;
<a name="l00273"></a>00273     CGSize                      _maxSize;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <a class="code" href="class_c_p_undo_manager.html">CPUndoManager</a>               _undoManager;
<a name="l00276"></a>00276     CPURL                       _representedURL;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     <a class="code" href="class_c_p_set.html">CPSet</a>                       _registeredDraggedTypes;
<a name="l00279"></a>00279     <a class="code" href="class_c_p_array.html">CPArray</a>                     _registeredDraggedTypesArray;
<a name="l00280"></a>00280     <a class="code" href="class_c_p_counted_set.html">CPCountedSet</a>                _inclusiveRegisteredDraggedTypes;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282     <a class="code" href="class_c_p_button.html">CPButton</a>                    _defaultButton;
<a name="l00283"></a>00283     BOOL                        _defaultButtonEnabled;
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     BOOL                        _autorecalculatesKeyViewLoop;
<a name="l00286"></a>00286     BOOL                        _keyViewLoopIsDirty;
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     <span class="comment">// Bridge Support</span>
<a name="l00289"></a>00289 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00290"></a>00290 <span class="preprocessor"></span>    DOMElement                  _DOMElement;
<a name="l00291"></a>00291 <span class="preprocessor">#endif</span>
<a name="l00292"></a>00292 <span class="preprocessor"></span>    <a class="code" href="class_c_p_d_o_m_window_bridge.html">CPDOMWindowBridge</a>           _bridge;
<a name="l00293"></a>00293     <span class="keywordtype">unsigned</span>                    _autoresizingMask;
<a name="l00294"></a>00294     
<a name="l00295"></a>00295     BOOL                        _delegateRespondsToWindowWillReturnUndoManagerSelector;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     BOOL                        _isFullBridge;
<a name="l00298"></a>00298     _CPWindowFullBridgeSession _fullBridgeSession;
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="comment">/*</span>
<a name="l00302"></a>00302 <span class="comment">    Private initializer for Objective-J</span>
<a name="l00303"></a>00303 <span class="comment">    @ignore</span>
<a name="l00304"></a>00304 <span class="comment">*/</span>
<a name="l00305"></a><a class="code" href="class_c_p_window.html#a90717e1a2e3efc1443a50f9b3bb8cb1b">00305</a> + (void)initialize
<a name="l00306"></a>00306 {
<a name="l00307"></a>00307     <span class="keywordflow">if</span> (<span class="keyword">self</span> != [<a class="code" href="class_c_p_window.html">CPWindow</a> <span class="keyword">class</span>])
<a name="l00308"></a>00308         <span class="keywordflow">return</span>;
<a name="l00309"></a>00309     
<a name="l00310"></a>00310     var bundle = [<a class="code" href="class_c_p_bundle.html">CPBundle</a> <a class="code" href="class_c_p_bundle.html#a6b2401dce4d84d49261126169d966567">bundleForClass</a>:[<a class="code" href="class_c_p_window.html">CPWindow</a> class]];
<a name="l00311"></a>00311     
<a name="l00312"></a>00312     <a class="code" href="_c_p_window_8j.html#a1cedf05cfa18440686df5fd4e2d62e74">CPWindowSavingImage</a> = [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPProgressIndicator/CPProgressIndicatorSpinningStyleRegular.gif&quot;] size:CGSizeMake(16.0, 16.0)]
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 
<a name="l00330"></a><a class="code" href="class_c_p_window.html#aa8899214bfb73355f8f5ea13a6bc3ca5">00330</a> - (id)initWithContentRect:(CGRect)aContentRect styleMask:(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)aStyleMask
<a name="l00331"></a>00331 {
<a name="l00332"></a>00332 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00333"></a>00333 <span class="preprocessor"></span>    <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abed00bf044afa8ddc93df1014ef7dc81">initWithContentRect</a>:aContentRect <a class="code" href="class_c_p_window.html#abed00bf044afa8ddc93df1014ef7dc81">styleMask</a>:aStyleMask <a class="code" href="class_c_p_window.html#abed00bf044afa8ddc93df1014ef7dc81">bridge</a>:[<a class="code" href="class_c_p_d_o_m_window_bridge.html">CPDOMWindowBridge</a> <a class="code" href="class_c_p_d_o_m_window_bridge.html#a00134dadaf7141eddc62755a4eb70246">sharedDOMWindowBridge</a>]];
<a name="l00334"></a>00334 <span class="preprocessor">#else</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>    <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abed00bf044afa8ddc93df1014ef7dc81">initWithContentRect</a>:aContentRect <a class="code" href="class_c_p_window.html#abed00bf044afa8ddc93df1014ef7dc81">styleMask</a>:aStyleMask <a class="code" href="class_c_p_window.html#abed00bf044afa8ddc93df1014ef7dc81">bridge</a>:nil];
<a name="l00336"></a>00336 <span class="preprocessor">#endif</span>
<a name="l00337"></a>00337 <span class="preprocessor"></span>}
<a name="l00338"></a>00338 
<a name="l00356"></a><a class="code" href="class_c_p_window.html#abed00bf044afa8ddc93df1014ef7dc81">00356</a> - (id)initWithContentRect:(CGRect)aContentRect styleMask:(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)aStyleMask bridge:(<a class="code" href="class_c_p_d_o_m_window_bridge.html">CPDOMWindowBridge</a>)aBridge
<a name="l00357"></a>00357 {
<a name="l00358"></a>00358     <span class="keyword">self</span> = [<span class="keyword">super</span> init];
<a name="l00359"></a>00359     
<a name="l00360"></a>00360     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l00361"></a>00361     {
<a name="l00362"></a>00362         _isFullBridge = NO;
<a name="l00363"></a>00363         _registeredDraggedTypes = [<a class="code" href="class_c_p_set.html">CPSet</a> <a class="code" href="class_c_p_set.html#a89623be28c3a0913db1967b667874d39">set</a>];
<a name="l00364"></a>00364         _registeredDraggedTypesArray = [];
<a name="l00365"></a>00365 
<a name="l00366"></a>00366         <span class="comment">// Set up our window number.</span>
<a name="l00367"></a>00367         _windowNumber = [CPApp._windows count];
<a name="l00368"></a>00368         <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._windows[_windowNumber] = <span class="keyword">self</span>;
<a name="l00369"></a>00369         
<a name="l00370"></a>00370         _styleMask = aStyleMask;
<a name="l00371"></a>00371         _level = <a class="code" href="_c_p_window_8j.html#af8c6804a600c65ea9e35419a2b807bd2">CPNormalWindowLevel</a>;
<a name="l00372"></a>00372         
<a name="l00373"></a>00373         _minSize = <a class="code" href="_c_g_geometry_8j.html#ae46727e9923eb30b151ac3cbf6f0be42">CGSizeMake</a>(0.0, 0.0);
<a name="l00374"></a>00374         _maxSize = <a class="code" href="_c_g_geometry_8j.html#ae46727e9923eb30b151ac3cbf6f0be42">CGSizeMake</a>(1000000.0, 1000000.0);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376         <span class="comment">// Create our border view which is the actual root of our view hierarchy.</span>
<a name="l00377"></a>00377         var windowViewClass = [[<span class="keyword">self</span> class] _windowViewClassForStyleMask:aStyleMask];
<a name="l00378"></a>00378         
<a name="l00379"></a>00379         _frame = [windowViewClass frameRectForContentRect:aContentRect];
<a name="l00380"></a>00380         _windowView = [[windowViewClass alloc] initWithFrame:CGRectMake(0.0, 0.0, CGRectGetWidth(_frame), CGRectGetHeight(_frame)) styleMask:aStyleMask];
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         [_windowView _setWindow:self];
<a name="l00383"></a>00383         [_windowView setNextResponder:self];
<a name="l00384"></a>00384 
<a name="l00385"></a>00385         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a4b299e3f1ade652283bce1f6c8e71b66">setMovableByWindowBackground</a>:aStyleMask &amp; CPHUDBackgroundWindowMask];
<a name="l00386"></a>00386         
<a name="l00387"></a>00387         <span class="comment">// Create a generic content view.</span>
<a name="l00388"></a>00388         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a534be05ab9332d4a8fe06dcaeeec50ed">setContentView</a>:[[<a class="code" href="class_c_p_view.html">CPView</a> alloc] initWithFrame:CGRectMakeZero()]];
<a name="l00389"></a>00389         
<a name="l00390"></a>00390         _firstResponder = <span class="keyword">self</span>;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00393"></a>00393 <span class="preprocessor"></span>        _DOMElement = document.createElement(<span class="stringliteral">&quot;div&quot;</span>);
<a name="l00394"></a>00394         
<a name="l00395"></a>00395         _DOMElement.style.position = <span class="stringliteral">&quot;absolute&quot;</span>;
<a name="l00396"></a>00396         _DOMElement.style.visibility = <span class="stringliteral">&quot;visible&quot;</span>;
<a name="l00397"></a>00397         _DOMElement.style.zIndex = 0;
<a name="l00398"></a>00398         
<a name="l00399"></a>00399         <a class="code" href="_c_p_d_o_m_display_server_8h.html#a75856b74f6280adbef51cd07108e12fa">CPDOMDisplayServerSetStyleLeftTop</a>(_DOMElement, NULL, _CGRectGetMinX(_frame), _CGRectGetMinY(_frame));
<a name="l00400"></a>00400         <a class="code" href="_c_p_d_o_m_display_server_8h.html#adb3fd88967e3b3b1a999c5dbb5aa7068">CPDOMDisplayServerSetStyleSize</a>(_DOMElement, 1, 1);
<a name="l00401"></a>00401         
<a name="l00402"></a>00402         <a class="code" href="_c_p_d_o_m_display_server_8h.html#a7674b6a309595bfd6886e83b5a7df3b2">CPDOMDisplayServerAppendChild</a>(_DOMElement, _windowView._DOMElement);
<a name="l00403"></a>00403 <span class="preprocessor">#endif</span>
<a name="l00404"></a>00404 <span class="preprocessor"></span>
<a name="l00405"></a>00405         [<span class="keyword">self</span> setBridge:aBridge];
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         [<span class="keyword">self</span> setNextResponder:CPApp];
<a name="l00408"></a>00408 
<a name="l00409"></a>00409         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">setHasShadow</a>:aStyleMask !== CPBorderlessWindowMask];
<a name="l00410"></a>00410 
<a name="l00411"></a>00411         <span class="keywordflow">if</span> (aStyleMask &amp; <a class="code" href="_c_p_window_8j.html#ab9cb38d9cbdffe2bab2f10a4688545bd">CPBorderlessBridgeWindowMask</a>)
<a name="l00412"></a>00412             [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ad43a3bd524d997fb8125644f101b5fbf">setFullBridge</a>:YES];
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         _defaultButtonEnabled = YES;
<a name="l00415"></a>00415         _keyViewLoopIsDirty = YES;
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417     
<a name="l00418"></a>00418     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l00419"></a>00419 }
<a name="l00420"></a>00420 
<a name="l00424"></a>00424 + (Class)_windowViewClassForStyleMask:(<span class="keywordtype">unsigned</span>)aStyleMask
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426     <span class="keywordflow">if</span> (aStyleMask &amp; <a class="code" href="_c_p_window_8j.html#a550358819a66f387034d69aef39cc480">CPHUDBackgroundWindowMask</a>)
<a name="l00427"></a>00427         <span class="keywordflow">return</span> _CPHUDWindowView;
<a name="l00428"></a>00428     
<a name="l00429"></a>00429     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aStyleMask === <a class="code" href="_c_p_window_8j.html#afe0620fbd4de9a3c50bfb818ecc35d66">CPBorderlessWindowMask</a>)
<a name="l00430"></a>00430         <span class="keywordflow">return</span> _CPBorderlessWindowView;
<a name="l00431"></a>00431     
<a name="l00432"></a>00432     <span class="keywordflow">return</span> _CPStandardWindowView;
<a name="l00433"></a>00433 }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 + (Class)_windowViewClassForFullBridgeStyleMask:(<span class="keywordtype">unsigned</span>)aStyleMask
<a name="l00436"></a>00436 {
<a name="l00437"></a>00437     <span class="keywordflow">return</span> _CPBorderlessBridgeWindowView;
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="class_c_p_window.html#acac0ce6d44cdd970a318b561d70f0596">00440</a> - (void)awakeFromCib
<a name="l00441"></a>00441 {
<a name="l00442"></a>00442     <span class="keywordflow">if</span> (_initialFirstResponder)
<a name="l00443"></a>00443         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:_initialFirstResponder];
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     _keyViewLoopIsDirty = ![<span class="keyword">self</span> _hasKeyViewLoop];
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 - (void)_setWindowView:(<a class="code" href="class_c_p_view.html">CPView</a>)aWindowView
<a name="l00449"></a>00449 {
<a name="l00450"></a>00450     <span class="keywordflow">if</span> (_windowView === aWindowView)
<a name="l00451"></a>00451         <span class="keywordflow">return</span>;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     var oldWindowView = _windowView;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455     _windowView = aWindowView;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (oldWindowView)
<a name="l00459"></a>00459     {
<a name="l00460"></a>00460         [oldWindowView _setWindow:nil];
<a name="l00461"></a>00461         [oldWindowView noteToolbarChanged];
<a name="l00462"></a>00462 
<a name="l00463"></a>00463         <a class="code" href="_c_p_d_o_m_display_server_8h.html#a516e8fe3a142194da3a9aa3cc9da1130">CPDOMDisplayServerRemoveChild</a>(_DOMElement, oldWindowView._DOMElement);
<a name="l00464"></a>00464     }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <span class="keywordflow">if</span> (_windowView)
<a name="l00467"></a>00467     {
<a name="l00468"></a>00468         <a class="code" href="_c_p_d_o_m_display_server_8h.html#a7674b6a309595bfd6886e83b5a7df3b2">CPDOMDisplayServerAppendChild</a>(_DOMElement, _windowView._DOMElement);
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         var contentRect = [_contentView convertRect:[_contentView bounds] toView:nil];
<a name="l00471"></a>00471 
<a name="l00472"></a>00472         contentRect.origin = [<span class="keyword">self</span> convertBaseToBridge:contentRect.origin];
<a name="l00473"></a>00473 
<a name="l00474"></a>00474         [_windowView _setWindow:self];
<a name="l00475"></a>00475         [_windowView setNextResponder:self];
<a name="l00476"></a>00476         [_windowView addSubview:_contentView];
<a name="l00477"></a>00477         [_windowView setTitle:_title];
<a name="l00478"></a>00478         [_windowView noteToolbarChanged];
<a name="l00479"></a>00479 
<a name="l00480"></a>00480         [<span class="keyword">self</span> setFrame:[<span class="keyword">self</span> frameRectForContentRect:contentRect]];
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482 <span class="preprocessor">#endif</span>
<a name="l00483"></a>00483 <span class="preprocessor"></span>}
<a name="l00484"></a>00484 
<a name="l00485"></a><a class="code" href="class_c_p_window.html#ad43a3bd524d997fb8125644f101b5fbf">00485</a> - (void)setFullBridge:(BOOL)shouldBeFullBridge
<a name="l00486"></a>00486 {
<a name="l00487"></a>00487     shouldBeFullBridge = !!shouldBeFullBridge;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <span class="keywordflow">if</span> (_isFullBridge === shouldBeFullBridge)
<a name="l00490"></a>00490         <span class="keywordflow">return</span>;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     _isFullBridge = shouldBeFullBridge;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="keywordflow">if</span> (_isFullBridge)
<a name="l00495"></a>00495     {
<a name="l00496"></a>00496         _fullBridgeSession = _CPWindowFullBridgeSessionMake(_windowView, [<span class="keyword">self</span> contentRectForFrameRect:[<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]], [<span class="keyword">self</span> hasShadow], [<span class="keyword">self</span> level]);
<a name="l00497"></a>00497 
<a name="l00498"></a>00498         var fullBridgeWindowViewClass = [[<span class="keyword">self</span> class] _windowViewClassForFullBridgeStyleMask:_styleMask],
<a name="l00499"></a>00499             windowView = [[fullBridgeWindowViewClass alloc] initWithFrame:CGRectMakeZero() styleMask:_styleMask];
<a name="l00500"></a>00500 
<a name="l00501"></a>00501         [<span class="keyword">self</span> _setWindowView:windowView];
<a name="l00502"></a>00502 
<a name="l00503"></a>00503         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab1e2a370eeb6dd942a3aed1e51fc12be">setLevel</a>:CPBackgroundWindowLevel];
<a name="l00504"></a>00504         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">setHasShadow</a>:NO];
<a name="l00505"></a>00505         [<span class="keyword">self</span> setAutoresizingMask:CPWindowWidthSizable | CPWindowHeightSizable];
<a name="l00506"></a>00506         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7e55ac7c5a17669d408e497b4ae7d651">setFrame</a>:[_bridge visibleFrame]];
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508     <span class="keywordflow">else</span>
<a name="l00509"></a>00509     {
<a name="l00510"></a>00510         var windowView = _fullBridgeSession.windowView;
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         [<span class="keyword">self</span> _setWindowView:windowView];
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab1e2a370eeb6dd942a3aed1e51fc12be">setLevel</a>:_fullBridgeSession.level];
<a name="l00515"></a>00515         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">setHasShadow</a>:_fullBridgeSession.hasShadow];
<a name="l00516"></a>00516         [<span class="keyword">self</span> setAutoresizingMask:CPWindowNotSizable];
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7e55ac7c5a17669d408e497b4ae7d651">setFrame</a>:[windowView frameRectForContentRect:_fullBridgeSession.contentRect]];
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520 }
<a name="l00521"></a>00521 
<a name="l00522"></a><a class="code" href="class_c_p_window.html#ade30edbf3782fb7f4e35a3eba6e52d62">00522</a> - (BOOL)isFullBridge
<a name="l00523"></a>00523 {
<a name="l00524"></a>00524     <span class="keywordflow">return</span> _isFullBridge;
<a name="l00525"></a>00525 }
<a name="l00526"></a>00526 
<a name="l00530"></a><a class="code" href="class_c_p_window.html#a8b303767f2922c1c0857b239d0714137">00530</a> - (unsigned)styleMask
<a name="l00531"></a>00531 {
<a name="l00532"></a>00532     <span class="keywordflow">return</span> _styleMask;
<a name="l00533"></a>00533 }
<a name="l00534"></a>00534 
<a name="l00541"></a><a class="code" href="class_c_p_window.html#a864679548e9f9ce65ffae4b70516afd5">00541</a> + (CGRect)frameRectForContentRect:(CGRect)aContentRect styleMask:(<span class="keywordtype">unsigned</span>)aStyleMask
<a name="l00542"></a>00542 {
<a name="l00543"></a>00543     <span class="keywordflow">return</span> [[[<span class="keyword">self</span> class] _windowViewClassForStyleMask:_styleMask] frameRectForContentRect:aContentRect];
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00550"></a><a class="code" href="class_c_p_window.html#ad0a4e8350730362dad9543e9ca762da5">00550</a> - (CGRect)contentRectForFrameRect:(CGRect)aFrame
<a name="l00551"></a>00551 {
<a name="l00552"></a>00552     <span class="keywordflow">return</span> [_windowView contentRectForFrameRect:aFrame];
<a name="l00553"></a>00553 }
<a name="l00554"></a>00554 
<a name="l00560"></a><a class="code" href="class_c_p_window.html#a6af6ec52f565970dbd8721414e478fa1">00560</a> - (CGRect)frameRectForContentRect:(CGRect)aContentRect
<a name="l00561"></a>00561 {
<a name="l00562"></a>00562     <span class="keywordflow">return</span> [_windowView frameRectForContentRect:aContentRect];
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00568"></a><a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">00568</a> - (CGRect)<a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>
<a name="l00569"></a>00569 {
<a name="l00570"></a>00570     <span class="keywordflow">return</span> _CGRectMakeCopy(_frame);
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00580"></a><a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">00580</a> - (void)setFrame:(CGRect)aFrame display:(BOOL)shouldDisplay animate:(BOOL)shouldAnimate
<a name="l00581"></a>00581 {
<a name="l00582"></a>00582     <span class="keywordflow">if</span> (shouldAnimate)
<a name="l00583"></a>00583     {
<a name="l00584"></a>00584         var animation = [[_CPWindowFrameAnimation alloc] initWithWindow:self targetFrame:aFrame];
<a name="l00585"></a>00585     
<a name="l00586"></a>00586         [animation startAnimation];
<a name="l00587"></a>00587     }
<a name="l00588"></a>00588     <span class="keywordflow">else</span>
<a name="l00589"></a>00589     {
<a name="l00590"></a>00590         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#af2c6d92c09cf5c4e3cb79e95a8487a4a">setFrameOrigin</a>:aFrame.origin];
<a name="l00591"></a>00591         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a78f54abf39bc3d0b26714ba417a284fa">setFrameSize</a>:aFrame.size];
<a name="l00592"></a>00592     }
<a name="l00593"></a>00593 }
<a name="l00594"></a>00594 
<a name="l00598"></a><a class="code" href="class_c_p_window.html#a7e55ac7c5a17669d408e497b4ae7d651">00598</a> - (void)setFrame:(CGRect)aFrame
<a name="l00599"></a>00599 {
<a name="l00600"></a>00600     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">setFrame</a>:aFrame <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">display</a>:YES <a class="code" href="class_c_p_window.html#aba68647b8dfa1d4f71efb87d86c35ad4">animate</a>:NO];
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00607"></a><a class="code" href="class_c_p_window.html#af2c6d92c09cf5c4e3cb79e95a8487a4a">00607</a> - (void)setFrameOrigin:(CGPoint)anOrigin
<a name="l00608"></a>00608 {
<a name="l00609"></a>00609     var origin = _frame.origin;
<a name="l00610"></a>00610     
<a name="l00611"></a>00611     <span class="keywordflow">if</span> (_CGPointEqualToPoint(origin, anOrigin))
<a name="l00612"></a>00612         <span class="keywordflow">return</span>;
<a name="l00613"></a>00613     
<a name="l00614"></a>00614     origin.x = anOrigin.x;
<a name="l00615"></a>00615     origin.y = anOrigin.y;
<a name="l00616"></a>00616     
<a name="l00617"></a>00617 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00618"></a>00618 <span class="preprocessor"></span>    <a class="code" href="_c_p_d_o_m_display_server_8h.html#a75856b74f6280adbef51cd07108e12fa">CPDOMDisplayServerSetStyleLeftTop</a>(_DOMElement, NULL, origin.x, origin.y);
<a name="l00619"></a>00619 <span class="preprocessor">#endif</span>
<a name="l00620"></a>00620 <span class="preprocessor"></span>
<a name="l00621"></a>00621     [[<a class="code" href="class_c_p_notification_center.html">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidMoveNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l00622"></a>00622 }
<a name="l00623"></a>00623 
<a name="l00628"></a><a class="code" href="class_c_p_window.html#a78f54abf39bc3d0b26714ba417a284fa">00628</a> - (void)setFrameSize:(CGSize)aSize
<a name="l00629"></a>00629 {
<a name="l00630"></a>00630     aSize = _CGSizeMake(<a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(<a class="code" href="_c_p_obj_j_runtime_8j.html#a45f5f88d061da0c18bcb6b6a854fe898">MAX</a>(aSize.width, _minSize.width), _maxSize.width), <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(<a class="code" href="_c_p_obj_j_runtime_8j.html#a45f5f88d061da0c18bcb6b6a854fe898">MAX</a>(aSize.height, _minSize.height), _maxSize.height));
<a name="l00631"></a>00631     
<a name="l00632"></a>00632     <span class="keywordflow">if</span> (_CGSizeEqualToSize(_frame.size, aSize))
<a name="l00633"></a>00633         <span class="keywordflow">return</span>;
<a name="l00634"></a>00634     
<a name="l00635"></a>00635     _frame.size = aSize;
<a name="l00636"></a>00636     
<a name="l00637"></a>00637     [_windowView setFrameSize:aSize];
<a name="l00638"></a>00638     
<a name="l00639"></a>00639     <span class="keywordflow">if</span> (_hasShadow)
<a name="l00640"></a>00640         [_shadowView setFrameSize:_CGSizeMake(SHADOW_MARGIN_LEFT + aSize.width + SHADOW_MARGIN_RIGHT, SHADOW_MARGIN_BOTTOM + aSize.height + SHADOW_MARGIN_TOP + SHADOW_DISTANCE)];
<a name="l00641"></a>00641     
<a name="l00642"></a>00642     <span class="keywordflow">if</span> (!_isAnimating &amp;&amp; [_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidResize:)])
<a name="l00643"></a>00643         [_delegate windowDidResize:self];
<a name="l00644"></a>00644 }
<a name="l00645"></a>00645 
<a name="l00650"></a><a class="code" href="class_c_p_window.html#a4c3bebfd3f9b356fe3528f8697e95b0a">00650</a> - (void)orderFront:(<span class="keywordtype">id</span>)aSender
<a name="l00651"></a>00651 {
<a name="l00652"></a>00652     [_bridge order:CPWindowAbove window:self relativeTo:nil];
<a name="l00653"></a>00653 }
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 <span class="comment">/*</span>
<a name="l00656"></a>00656 <span class="comment">    Makes the receiver the last window in the screen ordering.</span>
<a name="l00657"></a>00657 <span class="comment">    @param aSender the object that requested this</span>
<a name="l00658"></a>00658 <span class="comment">    @ignore</span>
<a name="l00659"></a>00659 <span class="comment">*/</span>
<a name="l00660"></a><a class="code" href="class_c_p_window.html#abc13040362286cae8d5d1f3974c51626">00660</a> - (void)orderBack:(<span class="keywordtype">id</span>)aSender
<a name="l00661"></a>00661 {
<a name="l00662"></a>00662     <span class="comment">//[_bridge order:CPWindowBelow</span>
<a name="l00663"></a>00663 }
<a name="l00664"></a>00664 
<a name="l00669"></a><a class="code" href="class_c_p_window.html#a7499cfb057ea3359b4d3bc3652efefaf">00669</a> - (void)orderOut:(<span class="keywordtype">id</span>)aSender
<a name="l00670"></a>00670 {
<a name="l00671"></a>00671     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowWillClose:)])
<a name="l00672"></a>00672         [_delegate windowWillClose:self];
<a name="l00673"></a>00673     
<a name="l00674"></a>00674     [_bridge order:CPWindowOut window:self relativeTo:nil];
<a name="l00675"></a>00675     
<a name="l00676"></a>00676     <span class="keywordflow">if</span> ([<a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a> keyWindow] == <span class="keyword">self</span>)
<a name="l00677"></a>00677     {
<a name="l00678"></a>00678         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7eccad1de6cc0ca8c23dae1d4eeca57c">resignKeyWindow</a>];
<a name="l00679"></a>00679         
<a name="l00680"></a>00680         <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._keyWindow = nil;
<a name="l00681"></a>00681     }
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00689"></a><a class="code" href="class_c_p_window.html#aa7d4a5bd56c90ba672b40bfcef38843b">00689</a> - (void)orderWindow:(CPWindowOrderingMode)aPlace relativeTo:(<span class="keywordtype">int</span>)otherWindowNumber
<a name="l00690"></a>00690 {
<a name="l00691"></a>00691     [_bridge order:aPlace window:self relativeTo:CPApp._windows[otherWindowNumber]];
<a name="l00692"></a>00692 }
<a name="l00693"></a>00693 
<a name="l00698"></a><a class="code" href="class_c_p_window.html#ab1e2a370eeb6dd942a3aed1e51fc12be">00698</a> - (void)setLevel:(<span class="keywordtype">int</span>)aLevel
<a name="l00699"></a>00699 {
<a name="l00700"></a>00700     _level = aLevel;
<a name="l00701"></a>00701 }
<a name="l00702"></a>00702 
<a name="l00706"></a><a class="code" href="class_c_p_window.html#a382c894d3d0ac1e20aba1b98c7bbddf2">00706</a> - (int)level
<a name="l00707"></a>00707 {
<a name="l00708"></a>00708     <span class="keywordflow">return</span> _level;
<a name="l00709"></a>00709 }
<a name="l00710"></a>00710 
<a name="l00714"></a><a class="code" href="class_c_p_window.html#ae49f85afe20484449e51489a84342abe">00714</a> - (BOOL)isVisible
<a name="l00715"></a>00715 {
<a name="l00716"></a>00716     <span class="keywordflow">return</span> _isVisible;
<a name="l00717"></a>00717 }
<a name="l00718"></a>00718 
<a name="l00722"></a><a class="code" href="class_c_p_window.html#a99f527b7d848e74e51d31b50e1a58468">00722</a> - (BOOL)showsResizeIndicator
<a name="l00723"></a>00723 {
<a name="l00724"></a>00724     <span class="keywordflow">return</span> [_windowView showsResizeIndicator];
<a name="l00725"></a>00725 }
<a name="l00726"></a>00726 
<a name="l00731"></a><a class="code" href="class_c_p_window.html#ae3c64bcd7e145e6db87654e6a2d2f829">00731</a> - (void)setShowsResizeIndicator:(BOOL)shouldShowResizeIndicator
<a name="l00732"></a>00732 {       
<a name="l00733"></a>00733     [_windowView setShowsResizeIndicator:shouldShowResizeIndicator];
<a name="l00734"></a>00734 }
<a name="l00735"></a>00735 
<a name="l00739"></a><a class="code" href="class_c_p_window.html#aa4716b33e16ac233fecd23b0c98cd133">00739</a> - (CGSize)resizeIndicatorOffset
<a name="l00740"></a>00740 {
<a name="l00741"></a>00741     <span class="keywordflow">return</span> [_windowView resizeIndicatorOffset];
<a name="l00742"></a>00742 }
<a name="l00743"></a>00743 
<a name="l00748"></a><a class="code" href="class_c_p_window.html#abdb142f571a0012cbf75f9c53ed71950">00748</a> - (void)setResizeIndicatorOffset:(CGSize)anOffset
<a name="l00749"></a>00749 {
<a name="l00750"></a>00750     [_windowView setResizeIndicatorOffset:anOffset];
<a name="l00751"></a>00751 }
<a name="l00752"></a>00752 
<a name="l00758"></a><a class="code" href="class_c_p_window.html#a534be05ab9332d4a8fe06dcaeeec50ed">00758</a> - (void)setContentView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l00759"></a>00759 {
<a name="l00760"></a>00760     <span class="keywordflow">if</span> (_contentView)
<a name="l00761"></a>00761         [_contentView removeFromSuperview];
<a name="l00762"></a>00762     
<a name="l00763"></a>00763     var bounds = <a class="code" href="_c_g_geometry_8j.html#aca150c0049e24797c6271bad7bc90610">CGRectMake</a>(0.0, 0.0, <a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(_frame), <a class="code" href="_c_g_geometry_8j.html#a09d2072d60c7f39b04a41705d640fa98">CGRectGetHeight</a>(_frame));
<a name="l00764"></a>00764     
<a name="l00765"></a>00765     _contentView = aView;
<a name="l00766"></a>00766     [_contentView setFrame:[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ad0a4e8350730362dad9543e9ca762da5">contentRectForFrameRect</a>:bounds]];
<a name="l00767"></a>00767     
<a name="l00768"></a>00768     [_contentView setAutoresizingMask:CPViewWidthSizable | CPViewHeightSizable];
<a name="l00769"></a>00769     [_windowView addSubview:_contentView];
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00775"></a><a class="code" href="class_c_p_window.html#ae8ea24657fb8bfaf38cba633ce8d4a21">00775</a> - (<a class="code" href="class_c_p_view.html">CPView</a>)contentView
<a name="l00776"></a>00776 {
<a name="l00777"></a>00777     <span class="keywordflow">return</span> _contentView;
<a name="l00778"></a>00778 }
<a name="l00779"></a>00779 
<a name="l00784"></a><a class="code" href="class_c_p_window.html#afa753c01eed9d857117b4d77dd1bfaba">00784</a> - (void)setBackgroundColor:(CPColor)aColor
<a name="l00785"></a>00785 {
<a name="l00786"></a>00786     [_windowView setBackgroundColor:aColor];
<a name="l00787"></a>00787 }
<a name="l00788"></a>00788 
<a name="l00792"></a><a class="code" href="class_c_p_window.html#a1dbcb5e82208efb74e44c9bf1e48682f">00792</a> - (CPColor)backgroundColor
<a name="l00793"></a>00793 {
<a name="l00794"></a>00794     <span class="keywordflow">return</span> [_windowView backgroundColor];
<a name="l00795"></a>00795 }
<a name="l00796"></a>00796 
<a name="l00802"></a><a class="code" href="class_c_p_window.html#a80b34a6cb65d947d4afe3ddaf5f51a8f">00802</a> - (void)setMinSize:(CGSize)aSize
<a name="l00803"></a>00803 {
<a name="l00804"></a>00804     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a1eefbb30f35d5c4f4473bec9a2ebff9f">CGSizeEqualToSize</a>(_minSize, aSize))
<a name="l00805"></a>00805         <span class="keywordflow">return</span>;
<a name="l00806"></a>00806     
<a name="l00807"></a>00807     _minSize = <a class="code" href="_c_g_geometry_8j.html#ac0ce05074e36a3ea5cdc40d111b6d8b5">CGSizeCreateCopy</a>(aSize);
<a name="l00808"></a>00808 
<a name="l00809"></a>00809     var size = <a class="code" href="_c_g_geometry_8j.html#affb0172e44ea288a2660c9a5394db33a">CGSizeMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>].size),
<a name="l00810"></a>00810         needsFrameChange = NO;
<a name="l00811"></a>00811     
<a name="l00812"></a>00812     <span class="keywordflow">if</span> (size.width &lt; _minSize.width)
<a name="l00813"></a>00813     {
<a name="l00814"></a>00814         size.width = _minSize.width;
<a name="l00815"></a>00815         needsFrameChange = YES;
<a name="l00816"></a>00816     }
<a name="l00817"></a>00817     
<a name="l00818"></a>00818     <span class="keywordflow">if</span> (size.height &lt; _minSize.height)
<a name="l00819"></a>00819     {
<a name="l00820"></a>00820         size.height = _minSize.height;
<a name="l00821"></a>00821         needsFrameChange = YES;
<a name="l00822"></a>00822     }
<a name="l00823"></a>00823     
<a name="l00824"></a>00824     <span class="keywordflow">if</span> (needsFrameChange)
<a name="l00825"></a>00825         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a78f54abf39bc3d0b26714ba417a284fa">setFrameSize</a>:size];
<a name="l00826"></a>00826 }
<a name="l00827"></a>00827 
<a name="l00831"></a><a class="code" href="class_c_p_window.html#ab227183c80e4c44053439b1f7a61590e">00831</a> - (CGSize)minSize
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833     <span class="keywordflow">return</span> _minSize;
<a name="l00834"></a>00834 }
<a name="l00835"></a>00835 
<a name="l00842"></a><a class="code" href="class_c_p_window.html#aa02cdc9f817ec2cad1750c48c96e86b1">00842</a> - (void)setMaxSize:(CGSize)aSize
<a name="l00843"></a>00843 {
<a name="l00844"></a>00844     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a1eefbb30f35d5c4f4473bec9a2ebff9f">CGSizeEqualToSize</a>(_maxSize, aSize))
<a name="l00845"></a>00845         <span class="keywordflow">return</span>;
<a name="l00846"></a>00846     
<a name="l00847"></a>00847     _maxSize = <a class="code" href="_c_g_geometry_8j.html#ac0ce05074e36a3ea5cdc40d111b6d8b5">CGSizeCreateCopy</a>(aSize);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849     var size = <a class="code" href="_c_g_geometry_8j.html#affb0172e44ea288a2660c9a5394db33a">CGSizeMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>].size),
<a name="l00850"></a>00850         needsFrameChange = NO;
<a name="l00851"></a>00851     
<a name="l00852"></a>00852     <span class="keywordflow">if</span> (size.width &gt; _maxSize.width)
<a name="l00853"></a>00853     {
<a name="l00854"></a>00854         size.width = _maxSize.width;
<a name="l00855"></a>00855         needsFrameChange = YES;
<a name="l00856"></a>00856     }
<a name="l00857"></a>00857     
<a name="l00858"></a>00858     <span class="keywordflow">if</span> (size.height &gt; _maxSize.height)
<a name="l00859"></a>00859     {
<a name="l00860"></a>00860         size.height = _maxSize.height;
<a name="l00861"></a>00861         needsFrameChange = YES;
<a name="l00862"></a>00862     }
<a name="l00863"></a>00863     
<a name="l00864"></a>00864     <span class="keywordflow">if</span> (needsFrameChange)
<a name="l00865"></a>00865         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a78f54abf39bc3d0b26714ba417a284fa">setFrameSize</a>:size];
<a name="l00866"></a>00866 }
<a name="l00867"></a>00867 
<a name="l00871"></a><a class="code" href="class_c_p_window.html#aa7168a15f2e0b7f0ee8d8702010090ae">00871</a> - (CGSize)maxSize
<a name="l00872"></a>00872 {
<a name="l00873"></a>00873     <span class="keywordflow">return</span> _maxSize;
<a name="l00874"></a>00874 }
<a name="l00875"></a>00875 
<a name="l00879"></a><a class="code" href="class_c_p_window.html#a353baefd1f7683c6b2b9cf0083f2ad45">00879</a> - (BOOL)hasShadow
<a name="l00880"></a>00880 {
<a name="l00881"></a>00881     <span class="keywordflow">return</span> _hasShadow;
<a name="l00882"></a>00882 }
<a name="l00883"></a>00883 
<a name="l00888"></a><a class="code" href="class_c_p_window.html#ab620f96fdedb91ae99a95eee0b3ff84b">00888</a> - (void)setHasShadow:(BOOL)shouldHaveShadow
<a name="l00889"></a>00889 {
<a name="l00890"></a>00890     <span class="keywordflow">if</span> (_hasShadow === shouldHaveShadow)
<a name="l00891"></a>00891         <span class="keywordflow">return</span>;
<a name="l00892"></a>00892     
<a name="l00893"></a>00893     _hasShadow = shouldHaveShadow;
<a name="l00894"></a>00894     
<a name="l00895"></a>00895     <span class="keywordflow">if</span> (_hasShadow)
<a name="l00896"></a>00896     {
<a name="l00897"></a>00897         var bounds = [_windowView bounds];
<a name="l00898"></a>00898         
<a name="l00899"></a>00899         _shadowView = [[<a class="code" href="class_c_p_view.html">CPView</a> alloc] initWithFrame:CGRectMake(-SHADOW_MARGIN_LEFT, -SHADOW_MARGIN_TOP + SHADOW_DISTANCE, 
<a name="l00900"></a>00900             SHADOW_MARGIN_LEFT + CGRectGetWidth(bounds) + SHADOW_MARGIN_RIGHT, SHADOW_MARGIN_TOP + CGRectGetHeight(bounds) + SHADOW_MARGIN_BOTTOM)];
<a name="l00901"></a>00901     
<a name="l00902"></a>00902         <span class="keywordflow">if</span> (!_CPWindowShadowColor)
<a name="l00903"></a>00903         {
<a name="l00904"></a>00904             var bundle = [<a class="code" href="class_c_p_bundle.html">CPBundle</a> <a class="code" href="class_c_p_bundle.html#a6b2401dce4d84d49261126169d966567">bundleForClass</a>:[<a class="code" href="class_c_p_window.html">CPWindow</a> class]];
<a name="l00905"></a>00905             
<a name="l00906"></a>00906             _CPWindowShadowColor = [CPColor colorWithPatternImage:[[<a class="code" href="class_c_p_nine_part_image.html">CPNinePartImage</a> alloc] initWithImageSlices:
<a name="l00907"></a>00907                 [
<a name="l00908"></a>00908                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow0.png&quot;] size:CGSizeMake(20.0, 19.0)],
<a name="l00909"></a>00909                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow1.png&quot;] size:CGSizeMake(1.0, 19.0)],
<a name="l00910"></a>00910                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow2.png&quot;] size:CGSizeMake(19.0, 19.0)],
<a name="l00911"></a>00911                     
<a name="l00912"></a>00912                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow3.png&quot;] size:CGSizeMake(20.0, 1.0)],
<a name="l00913"></a>00913                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow4.png&quot;] size:CGSizeMake(1.0, 1.0)],
<a name="l00914"></a>00914                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow5.png&quot;] size:CGSizeMake(19.0, 1.0)],
<a name="l00915"></a>00915                     
<a name="l00916"></a>00916                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow6.png&quot;] size:CGSizeMake(20.0, 18.0)],
<a name="l00917"></a>00917                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow7.png&quot;] size:CGSizeMake(1.0, 18.0)],
<a name="l00918"></a>00918                     [[<a class="code" href="class_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:[bundle pathForResource:@&quot;CPWindow/CPWindowShadow8.png&quot;] size:CGSizeMake(19.0, 18.0)]
<a name="l00919"></a>00919                 ]]];
<a name="l00920"></a>00920         }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922         [_shadowView setBackgroundColor:_CPWindowShadowColor];
<a name="l00923"></a>00923         [_shadowView setAutoresizingMask:CPViewWidthSizable | CPViewHeightSizable];
<a name="l00924"></a>00924         
<a name="l00925"></a>00925 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00926"></a>00926 <span class="preprocessor"></span>        <a class="code" href="_c_p_d_o_m_display_server_8h.html#a1aa00c9df58c03e393d941e22b99b576">CPDOMDisplayServerInsertBefore</a>(_DOMElement, _shadowView._DOMElement, _windowView._DOMElement);
<a name="l00927"></a>00927 <span class="preprocessor">#endif</span>
<a name="l00928"></a>00928 <span class="preprocessor"></span>    }
<a name="l00929"></a>00929     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_shadowView)
<a name="l00930"></a>00930     {
<a name="l00931"></a>00931 <span class="preprocessor">#if PLATFORM(DOM)</span>
<a name="l00932"></a>00932 <span class="preprocessor"></span>        <a class="code" href="_c_p_d_o_m_display_server_8h.html#a516e8fe3a142194da3a9aa3cc9da1130">CPDOMDisplayServerRemoveChild</a>(_DOMElement, _shadowView._DOMElement);
<a name="l00933"></a>00933 <span class="preprocessor">#endif</span>
<a name="l00934"></a>00934 <span class="preprocessor"></span>        _shadowView = nil;
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936 }
<a name="l00937"></a>00937 
<a name="l00942"></a><a class="code" href="class_c_p_window.html#af48d93f6f967c70b46203f7bfacabf18">00942</a> - (void)setDelegate:(<span class="keywordtype">id</span>)aDelegate
<a name="l00943"></a>00943 {
<a name="l00944"></a>00944     <span class="comment">// FIXME: Unregister for notifications!</span>
<a name="l00945"></a>00945 
<a name="l00946"></a>00946     _delegate = aDelegate;
<a name="l00947"></a>00947     
<a name="l00948"></a>00948     _delegateRespondsToWindowWillReturnUndoManagerSelector = [_delegate respondsToSelector:@selector(windowWillReturnUndoManager:)];
<a name="l00949"></a>00949 
<a name="l00950"></a>00950     var defaultCenter = [<a class="code" href="class_c_p_notification_center.html">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>];
<a name="l00951"></a>00951     
<a name="l00952"></a>00952     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidBecomeMain:)])
<a name="l00953"></a>00953         [defaultCenter
<a name="l00954"></a>00954             addObserver:_delegate
<a name="l00955"></a>00955                selector:@selector(windowDidBecomeMain:)
<a name="l00956"></a>00956                    name:CPWindowDidBecomeMainNotification
<a name="l00957"></a>00957                  object:self];
<a name="l00958"></a>00958 
<a name="l00959"></a>00959     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidResignMain:)])
<a name="l00960"></a>00960         [defaultCenter
<a name="l00961"></a>00961             addObserver:_delegate
<a name="l00962"></a>00962                selector:@selector(windowDidResignMain:)
<a name="l00963"></a>00963                    name:CPWindowDidResignMainNotification
<a name="l00964"></a>00964                  object:self];
<a name="l00965"></a>00965 
<a name="l00966"></a>00966     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidMove:)])
<a name="l00967"></a>00967         [defaultCenter
<a name="l00968"></a>00968             addObserver:_delegate
<a name="l00969"></a>00969                selector:@selector(windowDidMove:)
<a name="l00970"></a>00970                    name:CPWindowDidMoveNotification
<a name="l00971"></a>00971                  object:self];
<a name="l00972"></a>00972 }
<a name="l00973"></a>00973 
<a name="l00977"></a><a class="code" href="class_c_p_window.html#a8622589fd16eef8183794a3702d687fa">00977</a> - (id)delegate
<a name="l00978"></a>00978 {
<a name="l00979"></a>00979     <span class="keywordflow">return</span> _delegate;
<a name="l00980"></a>00980 }
<a name="l00981"></a>00981 
<a name="l00986"></a><a class="code" href="class_c_p_window.html#a3b1dc79f277cbb1c0537bdf8236fef35">00986</a> - (void)setWindowController:(<a class="code" href="class_c_p_window_controller.html">CPWindowController</a>)aWindowController
<a name="l00987"></a>00987 {
<a name="l00988"></a>00988     _windowController = aWindowController;
<a name="l00989"></a>00989 }
<a name="l00990"></a>00990 
<a name="l00994"></a><a class="code" href="class_c_p_window.html#a4e0b69f32847e5eb911065d2e8ecdd40">00994</a> - (<a class="code" href="class_c_p_window_controller.html">CPWindowController</a>)windowController
<a name="l00995"></a>00995 {
<a name="l00996"></a>00996     <span class="keywordflow">return</span> _windowController;
<a name="l00997"></a>00997 }
<a name="l00998"></a>00998 
<a name="l00999"></a><a class="code" href="class_c_p_window.html#a292db7974a7823aaaba1224107838e11">00999</a> - (void)doCommandBySelector:(<span class="keywordtype">SEL</span>)aSelector
<a name="l01000"></a>01000 {
<a name="l01001"></a>01001     <span class="keywordflow">if</span> ([_delegate respondsToSelector:aSelector])
<a name="l01002"></a>01002         [_delegate performSelector:aSelector];
<a name="l01003"></a>01003     <span class="keywordflow">else</span>
<a name="l01004"></a>01004         [<span class="keyword">super</span> doCommandBySelector:aSelector];
<a name="l01005"></a>01005 }
<a name="l01006"></a>01006 
<a name="l01007"></a><a class="code" href="class_c_p_window.html#a76f1ff51058c2920022da0268b40dde9">01007</a> - (BOOL)acceptsFirstResponder
<a name="l01008"></a>01008 {
<a name="l01009"></a>01009     <span class="keywordflow">return</span> YES;
<a name="l01010"></a>01010 }
<a name="l01011"></a>01011 
<a name="l01019"></a><a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">01019</a> - (void)makeFirstResponder:(<a class="code" href="class_c_p_responder.html">CPResponder</a>)aResponder
<a name="l01020"></a>01020 {
<a name="l01021"></a>01021     <span class="keywordflow">if</span> (_firstResponder == aResponder)
<a name="l01022"></a>01022         <span class="keywordflow">return</span> YES;
<a name="l01023"></a>01023 
<a name="l01024"></a>01024     <span class="keywordflow">if</span>(![_firstResponder resignFirstResponder])
<a name="l01025"></a>01025         <span class="keywordflow">return</span> NO;
<a name="l01026"></a>01026 
<a name="l01027"></a>01027     <span class="keywordflow">if</span>(!aResponder || ![aResponder acceptsFirstResponder] || ![aResponder becomeFirstResponder])
<a name="l01028"></a>01028     {
<a name="l01029"></a>01029         _firstResponder = <span class="keyword">self</span>;
<a name="l01030"></a>01030     
<a name="l01031"></a>01031         <span class="keywordflow">return</span> NO;
<a name="l01032"></a>01032     }
<a name="l01033"></a>01033 
<a name="l01034"></a>01034     _firstResponder = aResponder;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036     <span class="keywordflow">return</span> YES;
<a name="l01037"></a>01037 }
<a name="l01038"></a>01038 
<a name="l01042"></a><a class="code" href="class_c_p_window.html#ae3af926d15fa7e76e98f18e2797ea345">01042</a> - (<a class="code" href="class_c_p_responder.html">CPResponder</a>)firstResponder
<a name="l01043"></a>01043 {
<a name="l01044"></a>01044     <span class="keywordflow">return</span> _firstResponder;
<a name="l01045"></a>01045 }
<a name="l01046"></a>01046 
<a name="l01047"></a><a class="code" href="class_c_p_window.html#a714e6001c4a5314a60d3f9f93f73bd0f">01047</a> - (BOOL)acceptsMouseMovedEvents
<a name="l01048"></a>01048 {
<a name="l01049"></a>01049     <span class="keywordflow">return</span> _acceptsMouseMovedEvents;
<a name="l01050"></a>01050 }
<a name="l01051"></a>01051 
<a name="l01052"></a><a class="code" href="class_c_p_window.html#a2962fc840401f54afddc4db77fbf6076">01052</a> - (void)setAcceptsMouseMovedEvents:(BOOL)shouldAcceptMouseMovedEvents
<a name="l01053"></a>01053 {
<a name="l01054"></a>01054     _acceptsMouseMovedEvents = shouldAcceptMouseMovedEvents;
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 
<a name="l01057"></a><a class="code" href="class_c_p_window.html#a762a53680e43bf848778642618d45003">01057</a> - (BOOL)ignoresMouseEvents
<a name="l01058"></a>01058 {
<a name="l01059"></a>01059     <span class="keywordflow">return</span> _ignoresMouseEvents;
<a name="l01060"></a>01060 }
<a name="l01061"></a>01061 
<a name="l01062"></a><a class="code" href="class_c_p_window.html#a53cb5c76301222813be7fea88b7a7022">01062</a> - (void)setIgnoresMouseEvents:(BOOL)shouldIgnoreMouseEvents
<a name="l01063"></a>01063 {
<a name="l01064"></a>01064     _ignoresMouseEvents = shouldIgnoreMouseEvents;
<a name="l01065"></a>01065 }
<a name="l01066"></a>01066 
<a name="l01067"></a>01067 <span class="comment">// Managing Titles</span>
<a name="l01068"></a>01068 
<a name="l01072"></a><a class="code" href="class_c_p_window.html#a463f8f02036d1b07c639164f0cfebe6b">01072</a> - (<a class="code" href="class_c_p_string.html">CPString</a>)title
<a name="l01073"></a>01073 {
<a name="l01074"></a>01074     <span class="keywordflow">return</span> _title;
<a name="l01075"></a>01075 }
<a name="l01076"></a>01076 
<a name="l01080"></a><a class="code" href="class_c_p_window.html#ad0672968510870de1b33985dd17c5c8e">01080</a> - (void)setTitle:(<a class="code" href="class_c_p_string.html">CPString</a>)aTitle
<a name="l01081"></a>01081 {
<a name="l01082"></a>01082     _title = aTitle;
<a name="l01083"></a>01083     
<a name="l01084"></a>01084     [_windowView setTitle:aTitle];
<a name="l01085"></a>01085     
<a name="l01086"></a>01086     [<span class="keyword">self</span> _synchronizeMenuBarTitleWithWindowTitle];
<a name="l01087"></a>01087 }
<a name="l01088"></a>01088 
<a name="l01092"></a><a class="code" href="class_c_p_window.html#ae5edca41e0f08be59c198b684703733d">01092</a> - (void)setTitleWithRepresentedFilename:(<a class="code" href="class_c_p_string.html">CPString</a>)aFilePath
<a name="l01093"></a>01093 {
<a name="l01094"></a>01094     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae32de1160f3749c7b3b6790d2745ec96">setRepresentedFilename</a>:aFilePath];
<a name="l01095"></a>01095     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ad0672968510870de1b33985dd17c5c8e">setTitle</a>:[aFilePath <a class="code" href="class_c_p_string.html#ae3defdd5560a6206b6fc975194fb5fc6">lastPathComponent</a>]];
<a name="l01096"></a>01096 }
<a name="l01097"></a>01097 
<a name="l01101"></a><a class="code" href="class_c_p_window.html#ae32de1160f3749c7b3b6790d2745ec96">01101</a> - (void)setRepresentedFilename:(<a class="code" href="class_c_p_string.html">CPString</a>)aFilePath
<a name="l01102"></a>01102 {
<a name="l01103"></a>01103     <span class="comment">// FIXME: urls vs filepaths and all.</span>
<a name="l01104"></a>01104     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a1ea7de7732a0e36ec126e35d0f329dd6">setRepresentedURL</a>:aFilePath];
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01110"></a><a class="code" href="class_c_p_window.html#ab56377d2c61fdbf17ef33976f9bfd70c">01110</a> - (<a class="code" href="class_c_p_string.html">CPString</a>)representedFilename
<a name="l01111"></a>01111 {
<a name="l01112"></a>01112     <span class="keywordflow">return</span> _representedURL;
<a name="l01113"></a>01113 }
<a name="l01114"></a>01114 
<a name="l01118"></a><a class="code" href="class_c_p_window.html#a1ea7de7732a0e36ec126e35d0f329dd6">01118</a> - (void)setRepresentedURL:(CPURL)aURL
<a name="l01119"></a>01119 {
<a name="l01120"></a>01120     _representedURL = aURL;
<a name="l01121"></a>01121 }
<a name="l01122"></a>01122 
<a name="l01126"></a><a class="code" href="class_c_p_window.html#a53f43613ff02e2d46b710aacf5545452">01126</a> - (CPURL)representedURL
<a name="l01127"></a>01127 {
<a name="l01128"></a>01128     <span class="keywordflow">return</span> _representedURL;
<a name="l01129"></a>01129 }
<a name="l01130"></a>01130 
<a name="l01131"></a>01131 <span class="comment">// Moving</span>
<a name="l01132"></a>01132 
<a name="l01137"></a><a class="code" href="class_c_p_window.html#a4b299e3f1ade652283bce1f6c8e71b66">01137</a> - (void)setMovableByWindowBackground:(BOOL)shouldBeMovableByWindowBackground
<a name="l01138"></a>01138 {
<a name="l01139"></a>01139     _isMovableByWindowBackground = shouldBeMovableByWindowBackground;
<a name="l01140"></a>01140 }
<a name="l01141"></a>01141 
<a name="l01145"></a><a class="code" href="class_c_p_window.html#a850434b623ef87e37e6a45599652b4b6">01145</a> - (BOOL)isMovableByWindowBackground
<a name="l01146"></a>01146 {
<a name="l01147"></a>01147     <span class="keywordflow">return</span> _isMovableByWindowBackground;
<a name="l01148"></a>01148 }
<a name="l01149"></a>01149 
<a name="l01153"></a><a class="code" href="class_c_p_window.html#a7e4e5ae86bee1664fbda5e077016b1d0">01153</a> - (void)center
<a name="l01154"></a>01154 {
<a name="l01155"></a>01155     var size = [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">frame</a>].size,
<a name="l01156"></a>01156         bridgeSize = [_bridge contentBounds].size;
<a name="l01157"></a>01157     
<a name="l01158"></a>01158     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#af2c6d92c09cf5c4e3cb79e95a8487a4a">setFrameOrigin</a>:CGPointMake((bridgeSize.width - size.width) / 2.0, (bridgeSize.height - size.height) / 2.0)];
<a name="l01159"></a>01159 }
<a name="l01160"></a>01160 
<a name="l01165"></a><a class="code" href="class_c_p_window.html#a15c9ee5f8df2e0c2f575e663d3959c21">01165</a> - (void)sendEvent:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent
<a name="l01166"></a>01166 {
<a name="l01167"></a>01167     var type = [anEvent <a class="code" href="class_c_p_event.html#abbbd5ff6550996fa3ef524ef27a1ef80">type</a>],
<a name="l01168"></a>01168         point = [anEvent <a class="code" href="class_c_p_event.html#a5a57f4fa909de5d83e5402a8d8af4b94">locationInWindow</a>];
<a name="l01169"></a>01169 
<a name="l01170"></a>01170     <span class="keywordflow">switch</span> (type)
<a name="l01171"></a>01171     {
<a name="l01172"></a>01172         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a2d5100bbd68b5192c640acc7c6b48764">CPKeyUp</a>:               <span class="keywordflow">return</span> [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae3af926d15fa7e76e98f18e2797ea345">firstResponder</a>] <a class="code" href="class_c_p_responder.html#a6dfd1be3af74ea2b732205d06982ebfe">keyUp</a>:anEvent];
<a name="l01173"></a>01173         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a44b7200967c244a014e1ee34ad02ecd9">CPKeyDown</a>:             <span class="keywordflow">return</span> [[<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ae3af926d15fa7e76e98f18e2797ea345">firstResponder</a>] <a class="code" href="class_c_p_responder.html#ab79a1f20ad2061e44fcf08ced0e2d391">keyDown</a>:anEvent];
<a name="l01174"></a>01174 
<a name="l01175"></a>01175         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a27aba2fa2e11afafa2725dd5a177b35e">CPScrollWheel</a>:         <span class="keywordflow">return</span> [[_windowView hitTest:point] scrollWheel:anEvent];
<a name="l01176"></a>01176 
<a name="l01177"></a>01177         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a192f15362855840eb6cfb4177a6494ef">CPLeftMouseUp</a>:         <span class="keywordflow">if</span> (!_leftMouseDownView)
<a name="l01178"></a>01178                                         <span class="keywordflow">return</span> [[_windowView hitTest:point] mouseUp:anEvent];
<a name="l01179"></a>01179                                     
<a name="l01180"></a>01180                                     [_leftMouseDownView mouseUp:anEvent]
<a name="l01181"></a>01181                                     
<a name="l01182"></a>01182                                     _leftMouseDownView = nil;
<a name="l01183"></a>01183                                     
<a name="l01184"></a>01184                                     <span class="keywordflow">return</span>;
<a name="l01185"></a>01185         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a1e3613de4780ff7b45bace27a1521899">CPLeftMouseDown</a>:       _leftMouseDownView = [_windowView hitTest:point];
<a name="l01186"></a>01186                                     
<a name="l01187"></a>01187                                     <span class="keywordflow">if</span> (_leftMouseDownView != _firstResponder &amp;&amp; [_leftMouseDownView acceptsFirstResponder])
<a name="l01188"></a>01188                                         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:_leftMouseDownView];
<a name="l01189"></a>01189                 
<a name="l01190"></a>01190                                     var theWindow = [anEvent <a class="code" href="class_c_p_event.html#af9a0e45bbaba9bc6587a222e74bf0703">window</a>];
<a name="l01191"></a>01191                                     
<a name="l01192"></a>01192                                     <span class="keywordflow">if</span> ([theWindow isKeyWindow] || [theWindow becomesKeyOnlyIfNeeded])
<a name="l01193"></a>01193                                         <span class="keywordflow">return</span> [_leftMouseDownView mouseDown:anEvent];
<a name="l01194"></a>01194                                     <span class="keywordflow">else</span>
<a name="l01195"></a>01195                                     {
<a name="l01196"></a>01196                                         <span class="comment">// FIXME: delayed ordering?</span>
<a name="l01197"></a>01197                                         [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a53710ab84e1e114f090cd75d6a47033f">makeKeyAndOrderFront</a>:self];
<a name="l01198"></a>01198                                         
<a name="l01199"></a>01199                                         <span class="keywordflow">if</span> ([_leftMouseDownView acceptsFirstMouse:anEvent])
<a name="l01200"></a>01200                                             <span class="keywordflow">return</span> [_leftMouseDownView mouseDown:anEvent]
<a name="l01201"></a>01201                                     }
<a name="l01202"></a>01202                                     <span class="keywordflow">break</span>;
<a name="l01203"></a>01203         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a391b5492a8cbdfa1b84b349eb2120c4e">CPLeftMouseDragged</a>:    <span class="keywordflow">if</span> (!_leftMouseDownView)
<a name="l01204"></a>01204                                         <span class="keywordflow">return</span> [[_windowView hitTest:point] mouseDragged:anEvent];
<a name="l01205"></a>01205                                     
<a name="l01206"></a>01206                                     <span class="keywordflow">return</span> [_leftMouseDownView mouseDragged:anEvent];
<a name="l01207"></a>01207         
<a name="l01208"></a>01208         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#ad01d8900a24d2f095d84e3e08d36c937">CPRightMouseUp</a>:        <span class="keywordflow">return</span> [_rightMouseDownView mouseUp:anEvent];
<a name="l01209"></a>01209         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#af7881703a39edf5c57b0e51ed6123d49">CPRightMouseDown</a>:      _rightMouseDownView = [_windowView hitTest:point];
<a name="l01210"></a>01210                                     <span class="keywordflow">return</span> [_rightMouseDownView mouseDown:anEvent];
<a name="l01211"></a>01211         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a1fadebaac82052428820fc0da9eceaa5">CPRightMouseDragged</a>:   <span class="keywordflow">return</span> [_rightMouseDownView mouseDragged:anEvent];
<a name="l01212"></a>01212         
<a name="l01213"></a>01213         <span class="keywordflow">case</span> <a class="code" href="_c_p_event_8j.html#a5bdb3919044bdb124c16292b9e50f615">CPMouseMoved</a>:          <span class="keywordflow">if</span> (!_acceptsMouseMovedEvents)
<a name="l01214"></a>01214                                         <span class="keywordflow">return</span>;
<a name="l01215"></a>01215                                     
<a name="l01216"></a>01216                                     var hitTestView = [_windowView hitTest:point];
<a name="l01217"></a>01217         
<a name="l01218"></a>01218                                     <span class="keywordflow">if</span> (hitTestView != _mouseOverView)
<a name="l01219"></a>01219                                     {
<a name="l01220"></a>01220                                         <span class="keywordflow">if</span> (_mouseOverView)
<a name="l01221"></a>01221                                             [_mouseOverView mouseExited:[<a class="code" href="class_c_p_event.html">CPEvent</a> <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">mouseEventWithType</a>:CPMouseExited <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">location</a>:point 
<a name="l01222"></a>01222                                                 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">modifierFlags</a>:[anEvent <a class="code" href="class_c_p_event.html#ae1990580a2f73b19009f30f27ff1e396">modifierFlags</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">timestamp</a>:[anEvent <a class="code" href="class_c_p_event.html#ab290762686ceda8bb462e0e989f62e04">timestamp</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">windowNumber</a>:_windowNumber <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">context</a>:nil <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">eventNumber</a>:-1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">clickCount</a>:1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">pressure</a>:0]];
<a name="l01223"></a>01223                                     
<a name="l01224"></a>01224                                         <span class="keywordflow">if</span> (hitTestView)
<a name="l01225"></a>01225                                             [hitTestView mouseEntered:[<a class="code" href="class_c_p_event.html">CPEvent</a> <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">mouseEventWithType</a>:CPMouseEntered <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">location</a>:point 
<a name="l01226"></a>01226                                                 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">modifierFlags</a>:[anEvent <a class="code" href="class_c_p_event.html#ae1990580a2f73b19009f30f27ff1e396">modifierFlags</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">timestamp</a>:[anEvent <a class="code" href="class_c_p_event.html#ab290762686ceda8bb462e0e989f62e04">timestamp</a>] <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">windowNumber</a>:_windowNumber <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">context</a>:nil <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">eventNumber</a>:-1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">clickCount</a>:1 <a class="code" href="class_c_p_event.html#ab05997e830d1bb2022f57b2e29f6e878">pressure</a>:0]];
<a name="l01227"></a>01227                             
<a name="l01228"></a>01228                                         _mouseOverView = hitTestView;
<a name="l01229"></a>01229                                     }
<a name="l01230"></a>01230                                     
<a name="l01231"></a>01231                                     [_mouseOverView mouseMoved:anEvent];
<a name="l01232"></a>01232     }
<a name="l01233"></a>01233 }
<a name="l01234"></a>01234 
<a name="l01238"></a><a class="code" href="class_c_p_window.html#aca95f3e1077a7b8859badba268fabbec">01238</a> - (int)windowNumber
<a name="l01239"></a>01239 {
<a name="l01240"></a>01240     <span class="keywordflow">return</span> _windowNumber;
<a name="l01241"></a>01241 }
<a name="l01242"></a>01242 
<a name="l01247"></a><a class="code" href="class_c_p_window.html#a3cab8fa3cb78d27fbb996b460056a886">01247</a> - (void)becomeKeyWindow
<a name="l01248"></a>01248 {
<a name="l01249"></a>01249     <span class="keywordflow">if</span> (_firstResponder != <span class="keyword">self</span> &amp;&amp; [_firstResponder respondsToSelector:<span class="keyword">@selector</span>(becomeKeyWindow)])
<a name="l01250"></a>01250         [_firstResponder becomeKeyWindow];
<a name="l01251"></a>01251 }
<a name="l01252"></a>01252 
<a name="l01257"></a><a class="code" href="class_c_p_window.html#a25ceeb80ee62f143cf34adae95b39634">01257</a> - (BOOL)canBecomeKeyWindow
<a name="l01258"></a>01258 {
<a name="l01259"></a>01259     <span class="keywordflow">return</span> YES;
<a name="l01260"></a>01260 }
<a name="l01261"></a>01261 
<a name="l01265"></a><a class="code" href="class_c_p_window.html#ab7bb73cd5147bdc16b16d678ec91673e">01265</a> - (BOOL)isKeyWindow
<a name="l01266"></a>01266 {
<a name="l01267"></a>01267     <span class="keywordflow">return</span> [CPApp keyWindow] == <span class="keyword">self</span>;
<a name="l01268"></a>01268 }
<a name="l01269"></a>01269 
<a name="l01274"></a><a class="code" href="class_c_p_window.html#a53710ab84e1e114f090cd75d6a47033f">01274</a> - (void)makeKeyAndOrderFront:(<span class="keywordtype">id</span>)aSender
<a name="l01275"></a>01275 {
<a name="l01276"></a>01276     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a4c3bebfd3f9b356fe3528f8697e95b0a">orderFront</a>:self];
<a name="l01277"></a>01277     
<a name="l01278"></a>01278     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7e1d3d1abeac1feca2a1f9fd07ac37c1">makeKeyWindow</a>];
<a name="l01279"></a>01279     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a9ee2b9bd46241094df06934173c19d48">makeMainWindow</a>];
<a name="l01280"></a>01280 }
<a name="l01281"></a>01281 
<a name="l01285"></a><a class="code" href="class_c_p_window.html#a7e1d3d1abeac1feca2a1f9fd07ac37c1">01285</a> - (void)makeKeyWindow
<a name="l01286"></a>01286 {
<a name="l01287"></a>01287     <span class="keywordflow">if</span> (![<span class="keyword">self</span> canBecomeKeyWindow])
<a name="l01288"></a>01288         <span class="keywordflow">return</span>;
<a name="l01289"></a>01289 
<a name="l01290"></a>01290     [CPApp._keyWindow resignKeyWindow];
<a name="l01291"></a>01291     
<a name="l01292"></a>01292     <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._keyWindow = <span class="keyword">self</span>;
<a name="l01293"></a>01293     
<a name="l01294"></a>01294     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a3cab8fa3cb78d27fbb996b460056a886">becomeKeyWindow</a>];
<a name="l01295"></a>01295 }
<a name="l01296"></a>01296 
<a name="l01300"></a><a class="code" href="class_c_p_window.html#a7eccad1de6cc0ca8c23dae1d4eeca57c">01300</a> - (void)resignKeyWindow
<a name="l01301"></a>01301 {
<a name="l01302"></a>01302     <span class="keywordflow">if</span> (_firstResponder != <span class="keyword">self</span> &amp;&amp; [_firstResponder respondsToSelector:<span class="keyword">@selector</span>(resignKeyWindow)])
<a name="l01303"></a>01303         [_firstResponder resignKeyWindow];
<a name="l01304"></a>01304     
<a name="l01305"></a>01305     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowDidResignKey:)])
<a name="l01306"></a>01306         [_delegate windowDidResignKey:self];
<a name="l01307"></a>01307 }
<a name="l01308"></a>01308 
<a name="l01319"></a><a class="code" href="class_c_p_window.html#a8fa9719d87138612b70e39e49990cf75">01319</a> - (void)dragImage:(<a class="code" href="class_c_p_image.html">CPImage</a>)anImage at:(CGPoint)imageLocation offset:(CGSize)mouseOffset event:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent pasteboard:(<a class="code" href="class_c_p_pasteboard.html">CPPasteboard</a>)aPasteboard source:(<span class="keywordtype">id</span>)aSourceObject slideBack:(BOOL)slideBack
<a name="l01320"></a>01320 {
<a name="l01321"></a>01321     [[CPDragServer sharedDragServer] dragImage:anImage fromWindow:self at:[<span class="keyword">self</span> convertBaseToBridge:imageLocation] offset:mouseOffset event:anEvent pasteboard:aPasteboard source:aSourceObject slideBack:slideBack];
<a name="l01322"></a>01322 }
<a name="l01323"></a>01323 
<a name="l01324"></a>01324 - (void)_noteRegisteredDraggedTypes:(<a class="code" href="class_c_p_set.html">CPSet</a>)pasteboardTypes
<a name="l01325"></a>01325 {
<a name="l01326"></a>01326     <span class="keywordflow">if</span> (!pasteboardTypes)
<a name="l01327"></a>01327         <span class="keywordflow">return</span>;
<a name="l01328"></a>01328 
<a name="l01329"></a>01329     <span class="keywordflow">if</span> (!_inclusiveRegisteredDraggedTypes)
<a name="l01330"></a>01330         _inclusiveRegisteredDraggedTypes = [<a class="code" href="class_c_p_counted_set.html">CPCountedSet</a> set];
<a name="l01331"></a>01331 
<a name="l01332"></a>01332     [_inclusiveRegisteredDraggedTypes unionSet:pasteboardTypes];
<a name="l01333"></a>01333 }
<a name="l01334"></a>01334 
<a name="l01335"></a>01335 - (void)_noteUnregisteredDraggedTypes:(<a class="code" href="class_c_p_array.html">CPArray</a>)pasteboardTypes
<a name="l01336"></a>01336 {
<a name="l01337"></a>01337     <span class="keywordflow">if</span> (!pasteboardTypes)
<a name="l01338"></a>01338         <span class="keywordflow">return</span>;
<a name="l01339"></a>01339 
<a name="l01340"></a>01340     [_inclusiveRegisteredDraggedTypes minusSet:pasteboardTypes]
<a name="l01341"></a>01341 
<a name="l01342"></a>01342     <span class="keywordflow">if</span> ([_inclusiveRegisteredDraggedTypes count] === 0)
<a name="l01343"></a>01343         _inclusiveRegisteredDraggedTypes = nil;
<a name="l01344"></a>01344 }
<a name="l01345"></a>01345 
<a name="l01356"></a><a class="code" href="class_c_p_window.html#a251e101df023f927b4e7b6c324d490c4">01356</a> - (void)dragView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView at:(CGPoint)imageLocation offset:(CGSize)mouseOffset event:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent pasteboard:(<a class="code" href="class_c_p_pasteboard.html">CPPasteboard</a>)aPasteboard source:(<span class="keywordtype">id</span>)aSourceObject slideBack:(BOOL)slideBack
<a name="l01357"></a>01357 {
<a name="l01358"></a>01358     [[CPDragServer sharedDragServer] dragView:aView fromWindow:self at:[<span class="keyword">self</span> convertBaseToBridge:imageLocation] offset:mouseOffset event:anEvent pasteboard:aPasteboard source:aSourceObject slideBack:slideBack];
<a name="l01359"></a>01359 }
<a name="l01360"></a>01360 
<a name="l01365"></a><a class="code" href="class_c_p_window.html#a09143622a8bce3dbed5ddf871b40e89a">01365</a> - (void)registerForDraggedTypes:(<a class="code" href="class_c_p_array.html">CPArray</a>)pasteboardTypes
<a name="l01366"></a>01366 {
<a name="l01367"></a>01367     <span class="keywordflow">if</span> (!pasteboardTypes)
<a name="l01368"></a>01368         <span class="keywordflow">return</span>;
<a name="l01369"></a>01369 
<a name="l01370"></a>01370     [<span class="keyword">self</span> _noteUnregisteredDraggedTypes:_registeredDraggedTypes];
<a name="l01371"></a>01371     [_registeredDraggedTypes addObjectsFromArray:pasteboardTypes]
<a name="l01372"></a>01372     [<span class="keyword">self</span> _noteRegisteredDraggedTypes:_registeredDraggedTypes];
<a name="l01373"></a>01373 
<a name="l01374"></a>01374     _registeredDraggedTypesArray = nil;
<a name="l01375"></a>01375 }
<a name="l01376"></a>01376 
<a name="l01381"></a><a class="code" href="class_c_p_window.html#a9f16837f8fce108861c33f86f75ae4d1">01381</a> - (<a class="code" href="class_c_p_array.html">CPArray</a>)registeredDraggedTypes
<a name="l01382"></a>01382 {
<a name="l01383"></a>01383     <span class="keywordflow">if</span> (!_registeredDraggedTypesArray)
<a name="l01384"></a>01384         _registeredDraggedTypesArray = [_registeredDraggedTypes allObjects]
<a name="l01385"></a>01385 
<a name="l01386"></a>01386     <span class="keywordflow">return</span> _registeredDraggedTypesArray;
<a name="l01387"></a>01387 }
<a name="l01388"></a>01388 
<a name="l01392"></a><a class="code" href="class_c_p_window.html#aea19296d6bf76c61a3e3fb0e4618e59e">01392</a> - (void)unregisterDraggedTypes
<a name="l01393"></a>01393 {
<a name="l01394"></a>01394     [<span class="keyword">self</span> _noteUnregisteredDraggedTypes:_registeredDraggedTypes];
<a name="l01395"></a>01395 
<a name="l01396"></a>01396     _registeredDraggedTypes = [<a class="code" href="class_c_p_set.html">CPSet</a> <a class="code" href="class_c_p_set.html#a89623be28c3a0913db1967b667874d39">set</a>];
<a name="l01397"></a>01397     _registeredDraggedTypesArray = [];
<a name="l01398"></a>01398 }
<a name="l01399"></a>01399 
<a name="l01400"></a>01400 <span class="comment">// Accessing Editing Status</span>
<a name="l01401"></a>01401 
<a name="l01406"></a><a class="code" href="class_c_p_window.html#a34f16e66b7d303aa677f49f2cb4f9e49">01406</a> - (void)setDocumentEdited:(BOOL)isDocumentEdited
<a name="l01407"></a>01407 {
<a name="l01408"></a>01408     <span class="keywordflow">if</span> (_isDocumentEdited == isDocumentEdited)
<a name="l01409"></a>01409         <span class="keywordflow">return</span>;
<a name="l01410"></a>01410     
<a name="l01411"></a>01411     _isDocumentEdited = isDocumentEdited;
<a name="l01412"></a>01412     
<a name="l01413"></a>01413     [<a class="code" href="class_c_p_menu.html">CPMenu</a> _setMenuBarIconImageAlphaValue:_isDocumentEdited ? 0.5 : 1.0];
<a name="l01414"></a>01414 }
<a name="l01415"></a>01415 
<a name="l01419"></a><a class="code" href="class_c_p_window.html#a59619e4d7e9c3d4a0755a466fb16da31">01419</a> - (BOOL)isDocumentEdited
<a name="l01420"></a>01420 {
<a name="l01421"></a>01421     <span class="keywordflow">return</span> _isDocumentEdited;
<a name="l01422"></a>01422 }
<a name="l01423"></a>01423 
<a name="l01424"></a><a class="code" href="class_c_p_window.html#addbfd0b2c5307696366ab3a9e2d4fe4d">01424</a> - (void)setDocumentSaving:(BOOL)isDocumentSaving
<a name="l01425"></a>01425 {
<a name="l01426"></a>01426     <span class="keywordflow">if</span> (_isDocumentSaving == isDocumentSaving)
<a name="l01427"></a>01427         <span class="keywordflow">return</span>;
<a name="l01428"></a>01428     
<a name="l01429"></a>01429     _isDocumentSaving = isDocumentSaving;
<a name="l01430"></a>01430     
<a name="l01431"></a>01431     [<span class="keyword">self</span> _synchronizeSaveMenuWithDocumentSaving];
<a name="l01432"></a>01432     
<a name="l01433"></a>01433     [_windowView windowDidChangeDocumentSaving];
<a name="l01434"></a>01434 }
<a name="l01435"></a>01435 
<a name="l01436"></a><a class="code" href="class_c_p_window.html#aa8e5fe96d20aaedca3932234e6b3c775">01436</a> - (BOOL)isDocumentSaving
<a name="l01437"></a>01437 {
<a name="l01438"></a>01438     <span class="keywordflow">return</span> _isDocumentSaving;
<a name="l01439"></a>01439 }
<a name="l01440"></a>01440 
<a name="l01441"></a>01441 <span class="comment">/* @ignore */</span>
<a name="l01442"></a>01442 - (void)_synchronizeSaveMenuWithDocumentSaving
<a name="l01443"></a>01443 {
<a name="l01444"></a>01444     <span class="keywordflow">if</span> (![<span class="keyword">self</span> isMainWindow])
<a name="l01445"></a>01445         <span class="keywordflow">return</span>;
<a name="l01446"></a>01446 
<a name="l01447"></a>01447     var mainMenu = [CPApp mainMenu],
<a name="l01448"></a>01448         index = [mainMenu indexOfItemWithTitle:_isDocumentSaving ? @&quot;Save&quot; : @&quot;Saving...&quot;];
<a name="l01449"></a>01449         
<a name="l01450"></a>01450     <span class="keywordflow">if</span> (index == <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l01451"></a>01451         <span class="keywordflow">return</span>;
<a name="l01452"></a>01452     
<a name="l01453"></a>01453     var item = [mainMenu itemAtIndex:index];
<a name="l01454"></a>01454         
<a name="l01455"></a>01455     <span class="keywordflow">if</span> (_isDocumentSaving)
<a name="l01456"></a>01456     {
<a name="l01457"></a>01457         <a class="code" href="_c_p_window_8j.html#a51cefe6c4b9ce4b6f5f00509636cc76b">CPWindowSaveImage</a> = [item image];
<a name="l01458"></a>01458         
<a name="l01459"></a>01459         [item setTitle:@&quot;Saving...&quot;];
<a name="l01460"></a>01460         [item setImage:CPWindowSavingImage];
<a name="l01461"></a>01461         [item setEnabled:NO];
<a name="l01462"></a>01462     }
<a name="l01463"></a>01463     <span class="keywordflow">else</span>
<a name="l01464"></a>01464     {
<a name="l01465"></a>01465         [item setTitle:@&quot;Save&quot;];
<a name="l01466"></a>01466         [item setImage:CPWindowSaveImage];
<a name="l01467"></a>01467         [item setEnabled:YES];
<a name="l01468"></a>01468     }
<a name="l01469"></a>01469 }
<a name="l01470"></a>01470 
<a name="l01471"></a>01471 <span class="comment">// Closing Windows</span>
<a name="l01472"></a>01472 
<a name="l01477"></a><a class="code" href="class_c_p_window.html#a893de03e20eff8154ceb2796457ee62e">01477</a> - (void)performClose:(<span class="keywordtype">id</span>)aSender
<a name="l01478"></a>01478 {
<a name="l01479"></a>01479     <span class="comment">// Only send ONE windowShouldClose: message.</span>
<a name="l01480"></a>01480     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(windowShouldClose:)])
<a name="l01481"></a>01481     {
<a name="l01482"></a>01482         <span class="keywordflow">if</span> (![_delegate windowShouldClose:<span class="keyword">self</span>])
<a name="l01483"></a>01483             <span class="keywordflow">return</span>;
<a name="l01484"></a>01484     }
<a name="l01485"></a>01485     
<a name="l01486"></a>01486     <span class="comment">// Only check self is delegate does NOT implement this.  This also ensures this when delegate == self (returns true).</span>
<a name="l01487"></a>01487     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([<span class="keyword">self</span> respondsToSelector:<span class="keyword">@selector</span>(windowShouldClose:)] &amp;&amp; ![<span class="keyword">self</span> windowShouldClose:<span class="keyword">self</span>])
<a name="l01488"></a>01488         <span class="keywordflow">return</span>;
<a name="l01489"></a>01489     
<a name="l01490"></a>01490     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab1263a85dda8bbaa7e3aab8791305fa0">close</a>];
<a name="l01491"></a>01491 }
<a name="l01492"></a>01492 
<a name="l01497"></a><a class="code" href="class_c_p_window.html#ab1263a85dda8bbaa7e3aab8791305fa0">01497</a> - (void)close
<a name="l01498"></a>01498 {
<a name="l01499"></a>01499    [[<a class="code" href="class_c_p_notification_center.html">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowWillCloseNotification <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01500"></a>01500 
<a name="l01501"></a>01501    [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a7499cfb057ea3359b4d3bc3652efefaf">orderOut</a>:nil];
<a name="l01502"></a>01502 }
<a name="l01503"></a>01503 
<a name="l01504"></a>01504 <span class="comment">// Managing Main Status</span>
<a name="l01508"></a><a class="code" href="class_c_p_window.html#a5508c4d93c4a7d93f28c2aa6ad486814">01508</a> <span class="comment"></span>- (BOOL)isMainWindow
<a name="l01509"></a>01509 {
<a name="l01510"></a>01510     <span class="keywordflow">return</span> [CPApp mainWindow] == <span class="keyword">self</span>;
<a name="l01511"></a>01511 }
<a name="l01512"></a>01512 
<a name="l01516"></a><a class="code" href="class_c_p_window.html#ae19a9564994febb5c6c53331e773f8cf">01516</a> - (BOOL)canBecomeMainWindow
<a name="l01517"></a>01517 {
<a name="l01518"></a>01518     <span class="comment">// FIXME: Also check if we can resize and titlebar.</span>
<a name="l01519"></a>01519     <span class="keywordflow">if</span> ([<span class="keyword">self</span> isVisible])
<a name="l01520"></a>01520         <span class="keywordflow">return</span> YES;
<a name="l01521"></a>01521         
<a name="l01522"></a>01522     <span class="keywordflow">return</span> NO;
<a name="l01523"></a>01523 }
<a name="l01524"></a>01524 
<a name="l01528"></a><a class="code" href="class_c_p_window.html#a9ee2b9bd46241094df06934173c19d48">01528</a> - (void)makeMainWindow
<a name="l01529"></a>01529 {
<a name="l01530"></a>01530     <span class="keywordflow">if</span> (![<span class="keyword">self</span> canBecomeMainWindow])
<a name="l01531"></a>01531         <span class="keywordflow">return</span>;
<a name="l01532"></a>01532 
<a name="l01533"></a>01533     [CPApp._mainWindow resignMainWindow];
<a name="l01534"></a>01534     
<a name="l01535"></a>01535     <a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a>._mainWindow = <span class="keyword">self</span>;
<a name="l01536"></a>01536     
<a name="l01537"></a>01537     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a2a2e63fb79b44e28d6c194f8b0050cda">becomeMainWindow</a>];
<a name="l01538"></a>01538 }
<a name="l01539"></a>01539 
<a name="l01543"></a><a class="code" href="class_c_p_window.html#a2a2e63fb79b44e28d6c194f8b0050cda">01543</a> - (void)becomeMainWindow
<a name="l01544"></a>01544 {
<a name="l01545"></a>01545     [<span class="keyword">self</span> _synchronizeMenuBarTitleWithWindowTitle];
<a name="l01546"></a>01546     [<span class="keyword">self</span> _synchronizeSaveMenuWithDocumentSaving];
<a name="l01547"></a>01547     
<a name="l01548"></a>01548     [[<a class="code" href="class_c_p_notification_center.html">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>]
<a name="l01549"></a>01549         <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidBecomeMainNotification
<a name="l01550"></a>01550                       <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01551"></a>01551 }
<a name="l01552"></a>01552 
<a name="l01556"></a><a class="code" href="class_c_p_window.html#a596c9cf6406c5dd1f7cf08ac770c58ae">01556</a> - (void)resignMainWindow
<a name="l01557"></a>01557 {
<a name="l01558"></a>01558     [[<a class="code" href="class_c_p_notification_center.html">CPNotificationCenter</a> <a class="code" href="class_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>]
<a name="l01559"></a>01559         <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPWindowDidResignMainNotification
<a name="l01560"></a>01560                       <a class="code" href="class_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];
<a name="l01561"></a>01561 }
<a name="l01562"></a>01562 
<a name="l01563"></a>01563 <span class="comment">// Managing Toolbars</span>
<a name="l01567"></a><a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">01567</a> <span class="comment"></span>- (<a class="code" href="class_c_p_toolbar.html">CPToolbar</a>)toolbar
<a name="l01568"></a>01568 {
<a name="l01569"></a>01569     <span class="keywordflow">return</span> _toolbar;
<a name="l01570"></a>01570 }
<a name="l01571"></a>01571 
<a name="l01576"></a><a class="code" href="class_c_p_window.html#a3db9a0bcce7408d1e0fea4bf9c930a9f">01576</a> - (void)setToolbar:(<a class="code" href="class_c_p_toolbar.html">CPToolbar</a>)aToolbar
<a name="l01577"></a>01577 {
<a name="l01578"></a>01578     <span class="keywordflow">if</span> (_toolbar === aToolbar)
<a name="l01579"></a>01579         <span class="keywordflow">return</span>;
<a name="l01580"></a>01580     
<a name="l01581"></a>01581     <span class="comment">// If this has an owner, dump it!</span>
<a name="l01582"></a>01582     [[aToolbar _window] setToolbar:nil];
<a name="l01583"></a>01583     
<a name="l01584"></a>01584     <span class="comment">// This is no longer out toolbar.</span>
<a name="l01585"></a>01585     [_toolbar _setWindow:nil];
<a name="l01586"></a>01586     
<a name="l01587"></a>01587     _toolbar = aToolbar;
<a name="l01588"></a>01588     
<a name="l01589"></a>01589     <span class="comment">// THIS is our toolbar.</span>
<a name="l01590"></a>01590     [_toolbar _setWindow:self];
<a name="l01591"></a>01591     
<a name="l01592"></a>01592     [<span class="keyword">self</span> _noteToolbarChanged];
<a name="l01593"></a>01593 }
<a name="l01594"></a>01594 
<a name="l01595"></a><a class="code" href="class_c_p_window.html#a99692a4fb9610282a1e81dd6bb97d227">01595</a> - (void)toggleToolbarShown:(<span class="keywordtype">id</span>)aSender
<a name="l01596"></a>01596 {
<a name="l01597"></a>01597     var toolbar = [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">toolbar</a>];
<a name="l01598"></a>01598     
<a name="l01599"></a>01599     [<a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">toolbar</a> <a class="code" href="class_c_p_toolbar.html#ae67aa421e6a79f8eaf0e008fe7dbbeb2">setVisible</a>:![<a class="code" href="class_c_p_window.html#a9a4dceb293e1a80ec549859ac16090b0">toolbar</a> <a class="code" href="class_c_p_toolbar.html#a4f3e1d69eb45cc1335cf3bca6f779368">isVisible</a>]];
<a name="l01600"></a>01600 }
<a name="l01601"></a>01601 
<a name="l01602"></a>01602 - (void)_noteToolbarChanged
<a name="l01603"></a>01603 {
<a name="l01604"></a>01604     var <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a> = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]),
<a name="l01605"></a>01605         newFrame;
<a name="l01606"></a>01606 
<a name="l01607"></a>01607     [_windowView noteToolbarChanged];
<a name="l01608"></a>01608 
<a name="l01609"></a>01609     <span class="keywordflow">if</span> (_isFullBridge)
<a name="l01610"></a>01610         newFrame = [_bridge visibleFrame];
<a name="l01611"></a>01611     <span class="keywordflow">else</span>
<a name="l01612"></a>01612     {
<a name="l01613"></a>01613         newFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]);
<a name="l01614"></a>01614         
<a name="l01615"></a>01615         newFrame.origin = <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>.origin;
<a name="l01616"></a>01616     }
<a name="l01617"></a>01617     
<a name="l01618"></a>01618     [<span class="keyword">self</span> setFrame:newFrame];
<a name="l01619"></a>01619     <span class="comment">/*</span>
<a name="l01620"></a>01620 <span class="comment">    [_windowView setAnimatingToolbar:YES];</span>
<a name="l01621"></a>01621 <span class="comment">    [self setFrame:frame];</span>
<a name="l01622"></a>01622 <span class="comment">    [self setFrame:newFrame display:YES animate:YES];</span>
<a name="l01623"></a>01623 <span class="comment">    [_windowView setAnimatingToolbar:NO];</span>
<a name="l01624"></a>01624 <span class="comment">    */</span>
<a name="l01625"></a>01625 }
<a name="l01626"></a>01626 
<a name="l01627"></a>01627 <span class="comment">/* @ignore */</span>
<a name="l01628"></a>01628 - (void)_setAttachedSheetFrameOrigin
<a name="l01629"></a>01629 {
<a name="l01630"></a>01630     <span class="comment">// Position the sheet above the contentRect.</span>
<a name="l01631"></a>01631     var contentRect = [[<span class="keyword">self</span> contentView] frame],
<a name="l01632"></a>01632         sheetFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([_attachedSheet <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]);
<a name="l01633"></a>01633         
<a name="l01634"></a>01634    sheetFrame.origin.y = <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(_frame) + <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(contentRect);
<a name="l01635"></a>01635    sheetFrame.origin.x = <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(_frame) + FLOOR((<a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(_frame) - <a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(sheetFrame)) / 2.0);
<a name="l01636"></a>01636    
<a name="l01637"></a>01637    [_attachedSheet setFrameOrigin:sheetFrame.origin];
<a name="l01638"></a>01638 }
<a name="l01639"></a>01639 
<a name="l01640"></a>01640 <span class="comment">/* @ignore */</span>
<a name="l01641"></a>01641 - (void)_animateAttachedSheet
<a name="l01642"></a>01642 {
<a name="l01643"></a>01643 <span class="comment">/*    NSWindow *sheet = [sheetContext sheet];</span>
<a name="l01644"></a>01644 <span class="comment">    NSRect sheetFrame;</span>
<a name="l01645"></a>01645 <span class="comment"></span>
<a name="l01646"></a>01646 <span class="comment">    [_sheetContext autorelease];</span>
<a name="l01647"></a>01647 <span class="comment">   _sheetContext=[sheetContext retain];</span>
<a name="l01648"></a>01648 <span class="comment"></span>
<a name="l01649"></a>01649 <span class="comment">   [self _setSheetOrigin];</span>
<a name="l01650"></a>01650 <span class="comment">   sheetFrame = [sheet frame];</span>
<a name="l01651"></a>01651 <span class="comment">   </span>
<a name="l01652"></a>01652 <span class="comment">   [(NSWindowBackgroundView *)[sheet _backgroundView] setBorderType:NSButtonBorder];</span>
<a name="l01653"></a>01653 <span class="comment">   [[sheet contentView] setAutoresizesSubviews:NO];</span>
<a name="l01654"></a>01654 <span class="comment">   [[sheet contentView] setAutoresizingMask:NSViewNotSizable];</span>
<a name="l01655"></a>01655 <span class="comment">   </span>
<a name="l01656"></a>01656 <span class="comment">//   [(NSWindowBackgroundView *)[sheet _backgroundView] cacheImageForAnimation];</span>
<a name="l01657"></a>01657 <span class="comment">   </span>
<a name="l01658"></a>01658 <span class="comment">   [_attachedSheet setFrame:CPRectMake(CGRectGetMinX(sheetFrame), CGRectGetMinY(sheetFrame), CGRectGetWidth(sheetFrame), 0.0) display:YES];</span>
<a name="l01659"></a>01659 <span class="comment">   [sheet setFrame:NSMakeRect(sheetFrame.origin.x, NSMaxY([self frame]), sheetFrame.size.width, 0) display:YES];</span>
<a name="l01660"></a>01660 <span class="comment">   [self _setSheetOriginAndFront];</span>
<a name="l01661"></a>01661 <span class="comment">   </span>
<a name="l01662"></a>01662 <span class="comment">   [sheet setFrame:sheetFrame display:YES animate:YES];*/</span>
<a name="l01663"></a>01663 }
<a name="l01664"></a>01664 
<a name="l01665"></a>01665 <span class="comment">/* @ignore */</span>
<a name="l01666"></a>01666 - (void)_attachSheet:(<a class="code" href="class_c_p_window.html">CPWindow</a>)aSheet modalDelegate:(<span class="keywordtype">id</span>)aModalDelegate didEndSelector:(<span class="keywordtype">SEL</span>)aDidEndSelector contextInfo:(<span class="keywordtype">id</span>)aContextInfo
<a name="l01667"></a>01667 {
<a name="l01668"></a>01668     <span class="comment">// Set this as our attached sheet.</span>
<a name="l01669"></a>01669     _attachedSheet = aSheet;
<a name="l01670"></a>01670     
<a name="l01671"></a>01671     <span class="comment">// If a window is ever run as a sheet, then it&apos;s sheet bit is set to YES.</span>
<a name="l01672"></a>01672     aSheet._isSheet = YES;
<a name="l01673"></a>01673     
<a name="l01674"></a>01674     [<span class="keyword">self</span> _setAttachedSheetFrameOrigin];
<a name="l01675"></a>01675     
<a name="l01676"></a>01676     <span class="comment">// Place this window above ourselves.</span>
<a name="l01677"></a>01677     [_bridge order:CPWindowAbove window:aSheet relativeTo:self];
<a name="l01678"></a>01678 }
<a name="l01679"></a>01679 
<a name="l01683"></a><a class="code" href="class_c_p_window.html#ae5aa7ed31b068622d790c6997f40d30e">01683</a> - (<a class="code" href="class_c_p_window.html">CPWindow</a>)attachedSheet
<a name="l01684"></a>01684 {
<a name="l01685"></a>01685     <span class="keywordflow">return</span> _attachedSheet;
<a name="l01686"></a>01686 }
<a name="l01687"></a>01687 
<a name="l01691"></a><a class="code" href="class_c_p_window.html#a64d5d40a8db00592ea6e625295e2d84d">01691</a> - (BOOL)isSheet
<a name="l01692"></a>01692 {
<a name="l01693"></a>01693     <span class="keywordflow">return</span> _isSheet;
<a name="l01694"></a>01694 }
<a name="l01695"></a>01695 
<a name="l01696"></a>01696 <span class="comment">//</span>
<a name="l01697"></a>01697 <span class="comment">/*</span>
<a name="l01698"></a>01698 <span class="comment">    Used privately.</span>
<a name="l01699"></a>01699 <span class="comment">    @ignore</span>
<a name="l01700"></a>01700 <span class="comment">*/</span>
<a name="l01701"></a><a class="code" href="class_c_p_window.html#aa627e57a4b76b9b6f74c7fa9ff299d40">01701</a> - (BOOL)becomesKeyOnlyIfNeeded
<a name="l01702"></a>01702 {
<a name="l01703"></a>01703     <span class="keywordflow">return</span> NO;
<a name="l01704"></a>01704 }
<a name="l01705"></a>01705 
<a name="l01710"></a><a class="code" href="class_c_p_window.html#a9bf8bd32818c6a78abf357ff524524ef">01710</a> - (BOOL)worksWhenModal
<a name="l01711"></a>01711 {
<a name="l01712"></a>01712     <span class="keywordflow">return</span> NO;
<a name="l01713"></a>01713 }
<a name="l01714"></a>01714 
<a name="l01715"></a><a class="code" href="class_c_p_window.html#ad793741ac5555c266a8d7233315fc1b3">01715</a> - (void)keyDown:(<a class="code" href="class_c_p_event.html">CPEvent</a>)event
<a name="l01716"></a>01716 {
<a name="l01717"></a>01717     <span class="keywordflow">if</span> (![<span class="keyword">self</span> performKeyEquivalent:event])
<a name="l01718"></a>01718         [<span class="keyword">self</span> interpretKeyEvents:[event]];
<a name="l01719"></a>01719 }
<a name="l01720"></a>01720 
<a name="l01721"></a><a class="code" href="class_c_p_window.html#a31a0adf63f2c3f1555db40f19f6e0b1e">01721</a> - (void)insertNewline:(<span class="keywordtype">id</span>)sender
<a name="l01722"></a>01722 {
<a name="l01723"></a>01723     <span class="keywordflow">if</span> (_defaultButton &amp;&amp; _defaultButtonEnabled)
<a name="l01724"></a>01724         [_defaultButton performClick:nil];
<a name="l01725"></a>01725 }
<a name="l01726"></a>01726 
<a name="l01727"></a><a class="code" href="class_c_p_window.html#a7d2bcddeba1a632968ce1ba8b86e510f">01727</a> - (void)insertTab:(<span class="keywordtype">id</span>)sender
<a name="l01728"></a>01728 {
<a name="l01729"></a>01729     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a50be45492f5a15060f3f358dc7157d67">selectNextKeyView</a>:nil];
<a name="l01730"></a>01730 }
<a name="l01731"></a>01731 
<a name="l01732"></a>01732 - (void)_dirtyKeyViewLoop
<a name="l01733"></a>01733 {
<a name="l01734"></a>01734     <span class="keywordflow">if</span> (_autorecalculatesKeyViewLoop)
<a name="l01735"></a>01735         _keyViewLoopIsDirty = YES;
<a name="l01736"></a>01736 }
<a name="l01737"></a>01737 
<a name="l01738"></a>01738 - (BOOL)_hasKeyViewLoop
<a name="l01739"></a>01739 {
<a name="l01740"></a>01740     var subviews = [];
<a name="l01741"></a>01741 
<a name="l01742"></a>01742     [<span class="keyword">self</span> _appendSubviewsOf:_contentView toArray:subviews];
<a name="l01743"></a>01743 
<a name="l01744"></a>01744     <span class="keywordflow">for</span> (var i = 0, count = [subviews count]; i&lt;count; i++)
<a name="l01745"></a>01745     {
<a name="l01746"></a>01746         <span class="keywordflow">if</span> (subviews[i]._nextKeyView)
<a name="l01747"></a>01747             <span class="keywordflow">return</span> YES;
<a name="l01748"></a>01748     }
<a name="l01749"></a>01749 
<a name="l01750"></a>01750     <span class="keywordflow">return</span> NO;
<a name="l01751"></a>01751 }
<a name="l01752"></a>01752 
<a name="l01753"></a><a class="code" href="class_c_p_window.html#ad7802cda45e07f710b5da50740f1fd18">01753</a> - (void)recalculateKeyViewLoop
<a name="l01754"></a>01754 {
<a name="l01755"></a>01755     var subviews = [];
<a name="l01756"></a>01756     
<a name="l01757"></a>01757     [<span class="keyword">self</span> _appendSubviewsOf:_contentView toArray:subviews];
<a name="l01758"></a>01758 
<a name="l01759"></a>01759     var keyViewOrder = [subviews sortedArrayUsingFunction:keyViewComparator context:_contentView],
<a name="l01760"></a>01760         count = [keyViewOrder count];
<a name="l01761"></a>01761 
<a name="l01762"></a>01762     <span class="keywordflow">for</span> (var i=0; i&lt;count; i++)
<a name="l01763"></a>01763         [keyViewOrder[i] setNextKeyView:keyViewOrder[(i+1)%count]];
<a name="l01764"></a>01764     
<a name="l01765"></a>01765     _keyViewLoopIsDirty = NO;
<a name="l01766"></a>01766 }
<a name="l01767"></a>01767 
<a name="l01768"></a>01768 - (void)_appendSubviewsOf:(<a class="code" href="class_c_p_view.html">CPView</a>)aView toArray:(<a class="code" href="class_c_p_array.html">CPArray</a>)anArray
<a name="l01769"></a>01769 {
<a name="l01770"></a>01770     var subviews = [aView <a class="code" href="class_c_p_view.html#ad1d0643685491bf8e809d320fb7d6046">subviews</a>],
<a name="l01771"></a>01771         count = [subviews count];
<a name="l01772"></a>01772 
<a name="l01773"></a>01773     <span class="keywordflow">while</span> (count--)
<a name="l01774"></a>01774         [<span class="keyword">self</span> _appendSubviewsOf:subviews[count] toArray:anArray];
<a name="l01775"></a>01775 
<a name="l01776"></a>01776     [anArray <a class="code" href="class_c_p_array.html#aa9b30d4c68c37973bb2c61ff2bb9ba15">addObject</a>:aView];
<a name="l01777"></a>01777 }
<a name="l01778"></a>01778 
<a name="l01779"></a><a class="code" href="class_c_p_window.html#a0a7107837b6dad0b1addf74764d23798">01779</a> - (void)setAutorecalculatesKeyViewLoop:(BOOL)shouldRecalculate
<a name="l01780"></a>01780 {
<a name="l01781"></a>01781     <span class="keywordflow">if</span> (_autorecalculatesKeyViewLoop === shouldRecalculate)
<a name="l01782"></a>01782         <span class="keywordflow">return</span>;
<a name="l01783"></a>01783 
<a name="l01784"></a>01784     _autorecalculatesKeyViewLoop = shouldRecalculate;
<a name="l01785"></a>01785     
<a name="l01786"></a>01786     [<span class="keyword">self</span> _dirtyKeyViewLoop];
<a name="l01787"></a>01787 }
<a name="l01788"></a>01788 
<a name="l01789"></a><a class="code" href="class_c_p_window.html#a7d859d712c44fb75bdae849ae60dd7a5">01789</a> - (BOOL)autorecalculatesKeyViewLoop
<a name="l01790"></a>01790 {
<a name="l01791"></a>01791     <span class="keywordflow">return</span> _autorecalculatesKeyViewLoop;
<a name="l01792"></a>01792 }
<a name="l01793"></a>01793 
<a name="l01794"></a><a class="code" href="class_c_p_window.html#a50be45492f5a15060f3f358dc7157d67">01794</a> - (void)selectNextKeyView:(<span class="keywordtype">id</span>)sender
<a name="l01795"></a>01795 {
<a name="l01796"></a>01796     <span class="keywordflow">if</span> ([_firstResponder isKindOfClass:[<a class="code" href="class_c_p_view.html">CPView</a> <span class="keyword">class</span>]])
<a name="l01797"></a>01797         [<span class="keyword">self</span> selectKeyViewFollowingView:_firstResponder];
<a name="l01798"></a>01798 }
<a name="l01799"></a>01799 
<a name="l01800"></a><a class="code" href="class_c_p_window.html#a66bd5f7c00770b588786586a7eb0a584">01800</a> - (void)selectPreviousKeyView:(<span class="keywordtype">id</span>)sender
<a name="l01801"></a>01801 {
<a name="l01802"></a>01802     <span class="keywordflow">if</span> ([_firstResponder isKindOfClass:[<a class="code" href="class_c_p_view.html">CPView</a> <span class="keyword">class</span>]])
<a name="l01803"></a>01803         [<span class="keyword">self</span> selectKeyViewPrecedingView:_firstResponder];
<a name="l01804"></a>01804 }
<a name="l01805"></a>01805 
<a name="l01806"></a><a class="code" href="class_c_p_window.html#a65ba5d5047d99f1ff3469985ed738aa1">01806</a> - (void)selectKeyViewFollowingView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l01807"></a>01807 {
<a name="l01808"></a>01808     <span class="keywordflow">if</span> (_keyViewLoopIsDirty)
<a name="l01809"></a>01809         [<span class="keyword">self</span> recalculateKeyViewLoop];
<a name="l01810"></a>01810 
<a name="l01811"></a>01811     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:[aView <a class="code" href="class_c_p_view.html#a7b239de3414304837cedb99758362d83">nextValidKeyView</a>]];
<a name="l01812"></a>01812 }
<a name="l01813"></a>01813 
<a name="l01814"></a><a class="code" href="class_c_p_window.html#a98988c2a33e805855d55ccd056ee6620">01814</a> - (void)selectKeyViewPrecedingView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l01815"></a>01815 {
<a name="l01816"></a>01816     <span class="keywordflow">if</span> (_keyViewLoopIsDirty)
<a name="l01817"></a>01817         [<span class="keyword">self</span> recalculateKeyViewLoop];
<a name="l01818"></a>01818 
<a name="l01819"></a>01819     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#abaf02cdc9845e6ceb278b6fe6c4e0074">makeFirstResponder</a>:[aView <a class="code" href="class_c_p_view.html#ab8562f5d69d29e8097c932f839e22319">previousValidKeyView</a>]];
<a name="l01820"></a>01820 }
<a name="l01821"></a>01821 
<a name="l01822"></a><a class="code" href="class_c_p_window.html#a8f2af7f1c2ff045e7bf352152f163f09">01822</a> - (void)setDefaultButtonCell:(<a class="code" href="class_c_p_button.html">CPButton</a>)aButton
<a name="l01823"></a>01823 {
<a name="l01824"></a>01824     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a5d095d0bf95ddc40fc8c029902a2aaf9">setDefaultButton</a>:aButton];
<a name="l01825"></a>01825 }
<a name="l01826"></a>01826 
<a name="l01827"></a><a class="code" href="class_c_p_window.html#a418ed4703d31e53905f56b5607dfcb8c">01827</a> - (<a class="code" href="class_c_p_button.html">CPButton</a>)defaultButtonCell
<a name="l01828"></a>01828 {
<a name="l01829"></a>01829     <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a80c03301a77d490f7eaa1ad12e9f3f6f">defaultButton</a>];
<a name="l01830"></a>01830 }
<a name="l01831"></a>01831 
<a name="l01832"></a><a class="code" href="class_c_p_window.html#a5d095d0bf95ddc40fc8c029902a2aaf9">01832</a> - (void)setDefaultButton:(<a class="code" href="class_c_p_button.html">CPButton</a>)aButton
<a name="l01833"></a>01833 {
<a name="l01834"></a>01834     [_defaultButton setDefaultButton:NO];
<a name="l01835"></a>01835 
<a name="l01836"></a>01836     _defaultButton = aButton;
<a name="l01837"></a>01837 
<a name="l01838"></a>01838     [_defaultButton setDefaultButton:YES];    
<a name="l01839"></a>01839 }
<a name="l01840"></a>01840 
<a name="l01841"></a><a class="code" href="class_c_p_window.html#a80c03301a77d490f7eaa1ad12e9f3f6f">01841</a> - (<a class="code" href="class_c_p_button.html">CPButton</a>)defaultButton
<a name="l01842"></a>01842 {
<a name="l01843"></a>01843     <span class="keywordflow">return</span> _defaultButton;
<a name="l01844"></a>01844 }
<a name="l01845"></a>01845 
<a name="l01846"></a><a class="code" href="class_c_p_window.html#ac6c418d46a934a74e22d04729b54d3e8">01846</a> - (void)enableKeyEquivalentForDefaultButton
<a name="l01847"></a>01847 {
<a name="l01848"></a>01848     _defaultButtonEnabled = YES;
<a name="l01849"></a>01849 }
<a name="l01850"></a>01850 
<a name="l01851"></a><a class="code" href="class_c_p_window.html#a97786474426316f8c88c79f68a3727b6">01851</a> - (void)enableKeyEquivalentForDefaultButtonCell
<a name="l01852"></a>01852 {
<a name="l01853"></a>01853     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ac6c418d46a934a74e22d04729b54d3e8">enableKeyEquivalentForDefaultButton</a>];
<a name="l01854"></a>01854 }
<a name="l01855"></a>01855 
<a name="l01856"></a><a class="code" href="class_c_p_window.html#ab8cc65b32e81ffed354fd872880dcc51">01856</a> - (void)disableKeyEquivalentForDefaultButton
<a name="l01857"></a>01857 {
<a name="l01858"></a>01858     _defaultButtonEnabled = NO;
<a name="l01859"></a>01859 }
<a name="l01860"></a>01860 
<a name="l01861"></a><a class="code" href="class_c_p_window.html#acdb0a1e6dc138a3b7b9f64cd22190edf">01861</a> - (void)disableKeyEquivalentForDefaultButtonCell
<a name="l01862"></a>01862 {
<a name="l01863"></a>01863     [<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ab8cc65b32e81ffed354fd872880dcc51">disableKeyEquivalentForDefaultButton</a>];
<a name="l01864"></a>01864 }
<a name="l01865"></a>01865 
<a name="l01866"></a>01866 <span class="keyword">@end</span>
<a name="l01867"></a>01867 
<a name="l01868"></a>01868 var keyViewComparator = function(a, b, context)
<a name="l01869"></a>01869 {
<a name="l01870"></a>01870     var viewBounds = [a convertRect:[a bounds] toView:nil],
<a name="l01871"></a>01871         otherBounds = [b convertRect:[b bounds] toView:nil];
<a name="l01872"></a>01872 
<a name="l01873"></a>01873     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(viewBounds) &lt; <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(otherBounds))
<a name="l01874"></a>01874         <span class="keywordflow">return</span> -1;
<a name="l01875"></a>01875     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(viewBounds) == <a class="code" href="_c_g_geometry_8j.html#a9408ba6b0750742be8d630f59a3d4669">CGRectGetMinY</a>(otherBounds) &amp;&amp; <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(viewBounds) &lt; <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(otherBounds))
<a name="l01876"></a>01876         <span class="keywordflow">return</span> -1;
<a name="l01877"></a>01877     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(viewBounds) == <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(otherBounds) &amp;&amp; <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(viewBounds) == <a class="code" href="_c_g_geometry_8j.html#a7c1a8fe081097d577b441f6b7b553421">CGRectGetMinX</a>(otherBounds))
<a name="l01878"></a>01878         <span class="keywordflow">return</span> 0;
<a name="l01879"></a>01879     <span class="keywordflow">else</span>
<a name="l01880"></a>01880         <span class="keywordflow">return</span> 1;
<a name="l01881"></a>01881 }
<a name="l01882"></a>01882 
<a name="l01883"></a>01883 <span class="keyword">@implementation </span><a class="code" href="class_c_p_window.html">CPWindow</a> (MenuBar)
<a name="l01884"></a>01884 
<a name="l01885"></a>01885 - (void)_synchronizeMenuBarTitleWithWindowTitle
<a name="l01886"></a>01886 {
<a name="l01887"></a>01887     <span class="comment">// Windows with Documents automatically update the native window title and the menu bar title.</span>
<a name="l01888"></a>01888     <span class="keywordflow">if</span> (![_windowController document] || ![<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#a5508c4d93c4a7d93f28c2aa6ad486814">isMainWindow</a>])
<a name="l01889"></a>01889         <span class="keywordflow">return</span>;
<a name="l01890"></a>01890 
<a name="l01891"></a>01891     [<a class="code" href="class_c_p_menu.html">CPMenu</a> <a class="code" href="class_c_p_menu.html#a5c9673072cd4d8930741ea406397a974">setMenuBarTitle</a>:_title];
<a name="l01892"></a>01892 }
<a name="l01893"></a>01893 
<a name="l01894"></a>01894 <span class="keyword">@end</span>
<a name="l01895"></a>01895 
<a name="l01896"></a>01896 <span class="keyword">@implementation </span><a class="code" href="class_c_p_window.html">CPWindow</a> (BridgeSupport)
<a name="l01897"></a>01897 
<a name="l01898"></a>01898 <span class="comment">/*</span>
<a name="l01899"></a>01899 <span class="comment">    Sets the DOM-Window bridge for this window.</span>
<a name="l01900"></a>01900 <span class="comment">    @ignore</span>
<a name="l01901"></a>01901 <span class="comment">*/</span>
<a name="l01902"></a>01902 - (void)setBridge:(<a class="code" href="class_c_p_d_o_m_window_bridge.html">CPDOMWindowBridge</a>)aBridge
<a name="l01903"></a>01903 {
<a name="l01904"></a>01904     <span class="keywordflow">if</span> (_bridge == aBridge)
<a name="l01905"></a>01905         <span class="keywordflow">return</span>;
<a name="l01906"></a>01906         
<a name="l01907"></a>01907     <span class="keywordflow">if</span> (_bridge)
<a name="l01908"></a>01908     {
<a name="l01909"></a>01909         [<span class="keyword">self</span> orderOut:self];
<a name="l01910"></a>01910         <span class="comment">// FIXME: If the bridge changes, then we have to recreate all of our subviews&apos; DOM Elements.</span>
<a name="l01911"></a>01911     }
<a name="l01912"></a>01912 
<a name="l01913"></a>01913     _bridge = aBridge;
<a name="l01914"></a>01914     
<a name="l01915"></a>01915     <span class="keywordflow">if</span> ([<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ade30edbf3782fb7f4e35a3eba6e52d62">isFullBridge</a>])
<a name="l01916"></a>01916         [<span class="keyword">self</span> setFrame:[aBridge <a class="code" href="class_c_p_d_o_m_window_bridge.html#a3b62022c0d555619ff2e9b32d4e5a8c3">contentBounds</a>]];
<a name="l01917"></a>01917 }
<a name="l01918"></a>01918 
<a name="l01919"></a>01919 <span class="comment">/*</span>
<a name="l01920"></a>01920 <span class="comment">    @ignore</span>
<a name="l01921"></a>01921 <span class="comment">*/</span>
<a name="l01922"></a>01922 - (void)resizeWithOldBridgeSize:(CGSize)aSize
<a name="l01923"></a>01923 {
<a name="l01924"></a>01924     <span class="keywordflow">if</span> ([<span class="keyword">self</span> <a class="code" href="class_c_p_window.html#ade30edbf3782fb7f4e35a3eba6e52d62">isFullBridge</a>])
<a name="l01925"></a>01925         <span class="keywordflow">return</span> [<span class="keyword">self</span> setFrame:[_bridge visibleFrame]];
<a name="l01926"></a>01926     
<a name="l01927"></a>01927     <span class="keywordflow">if</span> (_autoresizingMask == <a class="code" href="_c_p_window_8j.html#a556155bbdc19382299b5ef083560284b">CPWindowNotSizable</a>)
<a name="l01928"></a>01928         <span class="keywordflow">return</span>;
<a name="l01929"></a>01929 
<a name="l01930"></a>01930     var <a class="code" href="class_c_p_window.html#a0eddef926f318eecaf793e702be6d5a5">frame</a> = [_bridge contentBounds],
<a name="l01931"></a>01931         newFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>(_frame),
<a name="l01932"></a>01932         dX = (<a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>(frame) - aSize.<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>) /
<a name="l01933"></a>01933             (((_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">CPWindowMinXMargin</a>) ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">CPWindowWidthSizable</a> ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#aa334d7b21d635b43f2e0a3ed993c19dd">CPWindowMaxXMargin</a> ? 1 : 0)),
<a name="l01934"></a>01934         dY = (<a class="code" href="_c_g_geometry_8j.html#a09d2072d60c7f39b04a41705d640fa98">CGRectGetHeight</a>(frame) - aSize.height) /
<a name="l01935"></a>01935             ((_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">CPWindowMinYMargin</a> ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">CPWindowHeightSizable</a> ? 1 : 0) + (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a46ec4bd30fada9b12a2cc412b40e7f07">CPWindowMaxYMargin</a> ? 1 : 0));
<a name="l01936"></a>01936 
<a name="l01937"></a>01937     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a9f8c18b9026cebcb2a1f8f91a01d5685">CPWindowMinXMargin</a>)
<a name="l01938"></a>01938         newFrame.origin.x += dX;
<a name="l01939"></a>01939     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a00f963c2ad31d2392edc1061592e1868">CPWindowWidthSizable</a>)
<a name="l01940"></a>01940         newFrame.size.width += dX;
<a name="l01941"></a>01941     
<a name="l01942"></a>01942     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#a602a019923a512326b42022289ca5238">CPWindowMinYMargin</a>)
<a name="l01943"></a>01943         newFrame.origin.y += dY;
<a name="l01944"></a>01944     <span class="keywordflow">if</span> (_autoresizingMask &amp; <a class="code" href="_c_p_window_8j.html#ad1bc138bdcf0c5b9690c8b1508c49f43">CPWindowHeightSizable</a>)
<a name="l01945"></a>01945         newFrame.size.height += dY;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947     [<span class="keyword">self</span> setFrame:newFrame];
<a name="l01948"></a>01948 }
<a name="l01949"></a>01949 
<a name="l01950"></a>01950 <span class="comment">/*</span>
<a name="l01951"></a>01951 <span class="comment">    @ignore</span>
<a name="l01952"></a>01952 <span class="comment">*/</span>
<a name="l01953"></a>01953 - (void)setAutoresizingMask:(<span class="keywordtype">unsigned</span>)anAutoresizingMask
<a name="l01954"></a>01954 {
<a name="l01955"></a>01955     _autoresizingMask = anAutoresizingMask;
<a name="l01956"></a>01956 }
<a name="l01957"></a>01957 
<a name="l01958"></a>01958 <span class="comment">/*</span>
<a name="l01959"></a>01959 <span class="comment">    @ignore</span>
<a name="l01960"></a>01960 <span class="comment">*/</span>
<a name="l01961"></a>01961 - (unsigned)autoresizingMask
<a name="l01962"></a>01962 {
<a name="l01963"></a>01963     <span class="keywordflow">return</span> _autoresizingMask;
<a name="l01964"></a>01964 }
<a name="l01965"></a>01965 
<a name="l01966"></a>01966 <span class="comment">/*</span>
<a name="l01967"></a>01967 <span class="comment">    @ignore</span>
<a name="l01968"></a>01968 <span class="comment">*/</span>
<a name="l01969"></a>01969 - (CGPoint)convertBaseToBridge:(CGPoint)aPoint
<a name="l01970"></a>01970 {
<a name="l01971"></a>01971     var origin = [<span class="keyword">self</span> frame].origin;
<a name="l01972"></a>01972     
<a name="l01973"></a>01973     <span class="keywordflow">return</span> <a class="code" href="_c_g_geometry_8j.html#a06c96cb5931220da52ff44b8ce9b603e">CGPointMake</a>(aPoint.x + origin.x, aPoint.y + origin.y);
<a name="l01974"></a>01974 }
<a name="l01975"></a>01975 
<a name="l01976"></a>01976 <span class="comment">/*</span>
<a name="l01977"></a>01977 <span class="comment">    @ignore</span>
<a name="l01978"></a>01978 <span class="comment">*/</span>
<a name="l01979"></a>01979 - (CGPoint)convertBridgeToBase:(CGPoint)aPoint
<a name="l01980"></a>01980 {
<a name="l01981"></a>01981     var origin = [<span class="keyword">self</span> frame].origin;
<a name="l01982"></a>01982     
<a name="l01983"></a>01983     <span class="keywordflow">return</span> <a class="code" href="_c_g_geometry_8j.html#a06c96cb5931220da52ff44b8ce9b603e">CGPointMake</a>(aPoint.x - origin.x, aPoint.y - origin.y);
<a name="l01984"></a>01984 }
<a name="l01985"></a>01985 
<a name="l01986"></a>01986 <span class="comment">// Undo and Redo Support</span>
<a name="l01990"></a>01990 <span class="comment"></span>- (<a class="code" href="class_c_p_undo_manager.html">CPUndoManager</a>)undoManager
<a name="l01991"></a>01991 {
<a name="l01992"></a>01992     <span class="keywordflow">if</span> (_delegateRespondsToWindowWillReturnUndoManagerSelector)
<a name="l01993"></a>01993         <span class="keywordflow">return</span> [_delegate windowWillReturnUndoManager:self];
<a name="l01994"></a>01994     
<a name="l01995"></a>01995     <span class="keywordflow">if</span> (!_undoManager)
<a name="l01996"></a>01996         _undoManager = [[<a class="code" href="class_c_p_undo_manager.html">CPUndoManager</a> alloc] init];
<a name="l01997"></a>01997 
<a name="l01998"></a>01998     <span class="keywordflow">return</span> _undoManager;
<a name="l01999"></a>01999 }
<a name="l02000"></a>02000 
<a name="l02005"></a>02005 - (void)undo:(<span class="keywordtype">id</span>)aSender
<a name="l02006"></a>02006 {
<a name="l02007"></a>02007     [[<span class="keyword">self</span> undoManager] undo];
<a name="l02008"></a>02008 }
<a name="l02009"></a>02009 
<a name="l02014"></a>02014 - (void)redo:(<span class="keywordtype">id</span>)aSender
<a name="l02015"></a>02015 {
<a name="l02016"></a>02016     [[<span class="keyword">self</span> undoManager] redo];
<a name="l02017"></a>02017 }
<a name="l02018"></a>02018 
<a name="l02019"></a>02019 - (BOOL)containsPoint:(CGPoint)aPoint
<a name="l02020"></a>02020 {
<a name="l02021"></a>02021     <span class="keywordflow">return</span> <a class="code" href="_c_g_geometry_8j.html#a1a96c087c2dc31ab61c3c88a3c6ec7c5">CGRectContainsPoint</a>(_frame, aPoint);
<a name="l02022"></a>02022 }
<a name="l02023"></a>02023 
<a name="l02024"></a>02024 <span class="keyword">@end</span>
<a name="l02025"></a>02025 
<a name="l02026"></a>02026 var interpolate = function(fromValue, toValue, progress)
<a name="l02027"></a>02027 {
<a name="l02028"></a>02028     <span class="keywordflow">return</span> fromValue + (toValue - fromValue) * progress;
<a name="l02029"></a>02029 }
<a name="l02030"></a>02030 
<a name="l02031"></a>02031 <span class="comment">/* @ignore */</span>
<a name="l02032"></a>02032 <span class="keyword">@implementation </span>_CPWindowFrameAnimation : <a class="code" href="class_c_p_animation.html">CPAnimation</a>
<a name="l02033"></a>02033 {
<a name="l02034"></a>02034     <a class="code" href="class_c_p_window.html">CPWindow</a>    _window;
<a name="l02035"></a>02035     
<a name="l02036"></a>02036     CGRect      _startFrame;
<a name="l02037"></a>02037     CGRect      _targetFrame;
<a name="l02038"></a>02038 }
<a name="l02039"></a>02039 
<a name="l02040"></a>02040 - (id)initWithWindow:(<a class="code" href="class_c_p_window.html">CPWindow</a>)aWindow targetFrame:(CGRect)aTargetFrame
<a name="l02041"></a>02041 {
<a name="l02042"></a>02042     <span class="keyword">self</span> = [<span class="keyword">super</span> initWithDuration:0.2 animationCurve:CPAnimationLinear];
<a name="l02043"></a>02043     
<a name="l02044"></a>02044     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l02045"></a>02045     {
<a name="l02046"></a>02046         _window = aWindow;
<a name="l02047"></a>02047         
<a name="l02048"></a>02048         _targetFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>(aTargetFrame);
<a name="l02049"></a>02049         _startFrame = <a class="code" href="_c_g_geometry_8j.html#a7521362038d81fa55cafbd6da5130335">CGRectMakeCopy</a>([_window <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]);
<a name="l02050"></a>02050     }
<a name="l02051"></a>02051     
<a name="l02052"></a>02052     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l02053"></a>02053 }
<a name="l02054"></a>02054 
<a name="l02055"></a>02055 - (void)startAnimation
<a name="l02056"></a>02056 {
<a name="l02057"></a>02057     [<span class="keyword">super</span> startAnimation];
<a name="l02058"></a>02058     
<a name="l02059"></a>02059     _window._isAnimating = YES;
<a name="l02060"></a>02060 }
<a name="l02061"></a>02061 
<a name="l02062"></a>02062 - (void)setCurrentProgress:(<span class="keywordtype">float</span>)aProgress
<a name="l02063"></a>02063 {
<a name="l02064"></a>02064     [<span class="keyword">super</span> setCurrentProgress:aProgress];
<a name="l02065"></a>02065     
<a name="l02066"></a>02066     var value = [<span class="keyword">self</span> currentValue];
<a name="l02067"></a>02067     
<a name="l02068"></a>02068     <span class="keywordflow">if</span> (value == 1.0)
<a name="l02069"></a>02069         _window._isAnimating = NO;
<a name="l02070"></a>02070     
<a name="l02071"></a>02071     [_window setFrameOrigin:CGPointMake(interpolate(CGRectGetMinX(_startFrame), CGRectGetMinX(_targetFrame), value), interpolate(CGRectGetMinY(_startFrame), CGRectGetMinY(_targetFrame), value))];
<a name="l02072"></a>02072     [_window setFrameSize:CGSizeMake(interpolate(CGRectGetWidth(_startFrame), CGRectGetWidth(_targetFrame), value), interpolate(CGRectGetHeight(_startFrame), CGRectGetHeight(_targetFrame), value))];
<a name="l02073"></a>02073 }
<a name="l02074"></a>02074 
<a name="l02075"></a>02075 <span class="keyword">@end</span>
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 function _CPWindowFullBridgeSessionMake(aWindowView, aContentRect, hasShadow, aLevel)
<a name="l02078"></a>02078 {
<a name="l02079"></a>02079     <span class="keywordflow">return</span> { windowView:aWindowView, contentRect:aContentRect, hasShadow:hasShadow, level:aLevel };
<a name="l02080"></a>02080 }
<a name="l02081"></a>02081 
<a name="l02082"></a>02082 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPWindowView.j&quot;</span>
<a name="l02083"></a>02083 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPStandardWindowView.j&quot;</span>
<a name="l02084"></a>02084 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPHUDWindowView.j&quot;</span>
<a name="l02085"></a>02085 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPBorderlessWindowView.j&quot;</span>
<a name="l02086"></a>02086 @<span class="keyword">import</span> <span class="stringliteral">&quot;_CPBorderlessBridgeWindowView.j&quot;</span>
<a name="l02087"></a>02087 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPDragServer.j&quot;</span>
<a name="l02088"></a>02088 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPDOMWindowBridge.j&quot;</span>
<a name="l02089"></a>02089 @<span class="keyword">import</span> <span class="stringliteral">&quot;CPView.j&quot;</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0,'all')"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1,'classes')"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2,'files')"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3,'functions')"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4,'variables')"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5,'defines')"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<a href="javascript:searchBox.CloseResultsWindow()" 
   id="MSearchResultsWindowClose"
   onmouseover="return searchBox.OnCloseHighlight(true)"
   onmouseout="return searchBox.OnCloseHighlight(false)"><img border="0" src="search/close.png" alt=""/></a>
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Sun Jul 5 21:41:28 2009 for Cappuccino by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.5.9-20090622 </small></address>
</body>
</html>
