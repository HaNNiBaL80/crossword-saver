<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
<title>Cappuccino: AppKit/CPCollectionView.j Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.5.9-20090622 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false);
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" 
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange()"/>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>AppKit/CPCollectionView.j</h1><a href="_c_p_collection_view_8j.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * CPCollectionView.j</span>
<a name="l00003"></a>00003 <span class="comment"> * AppKit</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Created by Francisco Tolmasky.</span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright 2008, 280 North, Inc.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
<a name="l00009"></a>00009 <span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="l00010"></a>00010 <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l00011"></a>00011 <span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span>
<a name="l00016"></a>00016 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment"> * License along with this library; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_array.html">CPArray</a>.j&gt;
<a name="l00024"></a>00024 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_data.html">CPData</a>.j&gt;
<a name="l00025"></a>00025 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_index_set.html">CPIndexSet</a>.j&gt;
<a name="l00026"></a>00026 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_keyed_archiver.html">CPKeyedArchiver</a>.j&gt;
<a name="l00027"></a>00027 @<span class="keyword">import</span> &lt;Foundation/<a class="code" href="class_c_p_keyed_unarchiver.html">CPKeyedUnarchiver</a>.j&gt;
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 @<span class="keyword">import</span> &lt;AppKit/<a class="code" href="class_c_p_view.html">CPView</a>.j&gt;
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 
<a name="l00064"></a><a class="code" href="class_c_p_collection_view.html">00064</a> <span class="keyword">@implementation </span><a class="code" href="class_c_p_collection_view.html">CPCollectionView</a> : <a class="code" href="class_c_p_view.html">CPView</a>
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066     <a class="code" href="class_c_p_array.html">CPArray</a>                 _content;
<a name="l00067"></a>00067     <a class="code" href="class_c_p_array.html">CPArray</a>                 _items;
<a name="l00068"></a>00068     
<a name="l00069"></a>00069     <a class="code" href="class_c_p_data.html">CPData</a>                  _itemData;
<a name="l00070"></a>00070     <a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a>    _itemPrototype;
<a name="l00071"></a>00071     <a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a>    _itemForDragging;
<a name="l00072"></a>00072     <a class="code" href="class_c_p_mutable_array.html">CPMutableArray</a>          _cachedItems;
<a name="l00073"></a>00073     
<a name="l00074"></a>00074     <span class="keywordtype">unsigned</span>                _maxNumberOfRows;
<a name="l00075"></a>00075     <span class="keywordtype">unsigned</span>                _maxNumberOfColumns;
<a name="l00076"></a>00076     
<a name="l00077"></a>00077     CGSize                  _minItemSize;
<a name="l00078"></a>00078     CGSize                  _maxItemSize;
<a name="l00079"></a>00079     
<a name="l00080"></a>00080     <span class="keywordtype">float</span>                   _tileWidth;
<a name="l00081"></a>00081     
<a name="l00082"></a>00082     BOOL                    _isSelectable;
<a name="l00083"></a>00083     BOOL                    _allowsMultipleSelection;
<a name="l00084"></a>00084     BOOL                    _allowsEmptySelection;
<a name="l00085"></a>00085     <a class="code" href="class_c_p_index_set.html">CPIndexSet</a>              _selectionIndexes;
<a name="l00086"></a>00086     
<a name="l00087"></a>00087     CGSize                  _itemSize;
<a name="l00088"></a>00088     
<a name="l00089"></a>00089     <span class="keywordtype">float</span>                   _horizontalMargin;
<a name="l00090"></a>00090     <span class="keywordtype">float</span>                   _verticalMargin;
<a name="l00091"></a>00091     
<a name="l00092"></a>00092     <span class="keywordtype">unsigned</span>                _numberOfRows;
<a name="l00093"></a>00093     <span class="keywordtype">unsigned</span>                _numberOfColumns;
<a name="l00094"></a>00094     
<a name="l00095"></a>00095     <span class="keywordtype">id</span>                      _delegate;
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="class_c_p_collection_view.html#a670cf4d30a6910f39214aa55666e73d0">00098</a> - (id)initWithFrame:(CGRect)aFrame
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100     <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:aFrame];
<a name="l00101"></a>00101     
<a name="l00102"></a>00102     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l00103"></a>00103     {
<a name="l00104"></a>00104         _items = [];
<a name="l00105"></a>00105         _content = [];
<a name="l00106"></a>00106         
<a name="l00107"></a>00107         _cachedItems = [];
<a name="l00108"></a>00108         
<a name="l00109"></a>00109         _itemSize = <a class="code" href="_c_g_geometry_8j.html#ab8e35bab228754c325f263092a141847">CGSizeMakeZero</a>();
<a name="l00110"></a>00110         _minItemSize = <a class="code" href="_c_g_geometry_8j.html#ab8e35bab228754c325f263092a141847">CGSizeMakeZero</a>();
<a name="l00111"></a>00111         _maxItemSize = <a class="code" href="_c_g_geometry_8j.html#ab8e35bab228754c325f263092a141847">CGSizeMakeZero</a>();
<a name="l00112"></a>00112         
<a name="l00113"></a>00113         _verticalMargin = 5.0;
<a name="l00114"></a>00114         _tileWidth = -1.0;
<a name="l00115"></a>00115         
<a name="l00116"></a>00116         _selectionIndexes = [<a class="code" href="class_c_p_index_set.html">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00117"></a>00117         _allowsEmptySelection = YES;
<a name="l00118"></a>00118         _isSelectable = YES;
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120     
<a name="l00121"></a>00121     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00128"></a><a class="code" href="class_c_p_collection_view.html#afb0dd4eff77d1850ad7232f518dc9190">00128</a> - (void)setItemPrototype:(<a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a>)anItem
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130     _itemData = [<a class="code" href="class_c_p_keyed_archiver.html">CPKeyedArchiver</a> <a class="code" href="class_c_p_keyed_archiver.html#ac8e2ae91f9747f762e797c1950fd1c08">archivedDataWithRootObject</a>:anItem];
<a name="l00131"></a>00131     _itemForDragging = anItem<span class="comment">//[CPKeyedUnarchiver unarchiveObjectWithData:_itemData];</span>
<a name="l00132"></a>00132     _itemPrototype = anItem;
<a name="l00133"></a>00133     
<a name="l00134"></a>00134     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#ad49cfac8afb29920f92406655277db69">reloadContent</a>];
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00140"></a><a class="code" href="class_c_p_collection_view.html#a56430b3ed3495d8b8d3968dc560b6450">00140</a> - (<a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a>)itemPrototype
<a name="l00141"></a>00141 {
<a name="l00142"></a>00142     <span class="keywordflow">return</span> _itemPrototype;
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00149"></a><a class="code" href="class_c_p_collection_view.html#a5d65159f53e01c4db9044edd562fef06">00149</a> - (<a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a>)newItemForRepresentedObject:(<span class="keywordtype">id</span>)anObject
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151     var item = nil;
<a name="l00152"></a>00152     
<a name="l00153"></a>00153     <span class="keywordflow">if</span> (_cachedItems.length)
<a name="l00154"></a>00154         item = _cachedItems.pop();
<a name="l00155"></a>00155     <span class="keywordflow">else</span>
<a name="l00156"></a>00156         item = [<a class="code" href="class_c_p_keyed_unarchiver.html">CPKeyedUnarchiver</a> <a class="code" href="class_c_p_keyed_unarchiver.html#a1cdd1eba3d2e27060962845b0ef3a380">unarchiveObjectWithData</a>:_itemData];
<a name="l00157"></a>00157 
<a name="l00158"></a>00158     [item setRepresentedObject:anObject];
<a name="l00159"></a>00159     [[item view] setFrameSize:_itemSize];
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="keywordflow">return</span> item;
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164 <span class="comment">// Working with the Responder Chain</span>
<a name="l00168"></a><a class="code" href="class_c_p_collection_view.html#a3563345f48c3f0fe7aa22e66b4cda7ef">00168</a> <span class="comment"></span>- (BOOL)acceptsFirstResponder
<a name="l00169"></a>00169 {
<a name="l00170"></a>00170     <span class="keywordflow">return</span> YES;
<a name="l00171"></a>00171 }
<a name="l00172"></a>00172 
<a name="l00176"></a><a class="code" href="class_c_p_collection_view.html#a83d4ca2375d928fd45e85bf1c4c6be30">00176</a> - (BOOL)isFirstResponder
<a name="l00177"></a>00177 {
<a name="l00178"></a>00178     <span class="keywordflow">return</span> [[<span class="keyword">self</span> window] firstResponder] == <span class="keyword">self</span>;
<a name="l00179"></a>00179 }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="comment">// Setting the Content</span>
<a name="l00188"></a><a class="code" href="class_c_p_collection_view.html#a4133f0edce38408146b8d7494eb45e5e">00188</a> <span class="comment"></span>- (void)setContent:(<a class="code" href="class_c_p_array.html">CPArray</a>)anArray
<a name="l00189"></a>00189 {
<a name="l00190"></a>00190     <span class="keywordflow">if</span> (_content == anArray)
<a name="l00191"></a>00191         <span class="keywordflow">return</span>;
<a name="l00192"></a>00192     
<a name="l00193"></a>00193     _content = anArray;
<a name="l00194"></a>00194     
<a name="l00195"></a>00195     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#ad49cfac8afb29920f92406655277db69">reloadContent</a>];
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00201"></a><a class="code" href="class_c_p_collection_view.html#af07e19e543c46b267917175cacf8cd5a">00201</a> - (<a class="code" href="class_c_p_array.html">CPArray</a>)content
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203     <span class="keywordflow">return</span> _content;
<a name="l00204"></a>00204 }
<a name="l00205"></a>00205 
<a name="l00209"></a><a class="code" href="class_c_p_collection_view.html#ab36541e44498daf17424f213ce65f40a">00209</a> - (<a class="code" href="class_c_p_array.html">CPArray</a>)items
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211     <span class="keywordflow">return</span> _items;
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 <span class="comment">// Setting the Selection Mode</span>
<a name="l00219"></a><a class="code" href="class_c_p_collection_view.html#a43b2c3e265ade383cf13fe921135e285">00219</a> <span class="comment"></span>- (void)setSelectable:(BOOL)isSelectable
<a name="l00220"></a>00220 {
<a name="l00221"></a>00221     <span class="keywordflow">if</span> (_isSelectable == isSelectable)
<a name="l00222"></a>00222         <span class="keywordflow">return</span>;
<a name="l00223"></a>00223     
<a name="l00224"></a>00224     _isSelectable = isSelectable;
<a name="l00225"></a>00225     
<a name="l00226"></a>00226     <span class="keywordflow">if</span> (!_isSelectable)
<a name="l00227"></a>00227     {
<a name="l00228"></a>00228         var index = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l00229"></a>00229         
<a name="l00230"></a>00230         <span class="keywordflow">while</span> ((index = [_selectionIndexes indexGreaterThanIndex:index]) != <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l00231"></a>00231             [_items[index] setSelected:NO];
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233 }
<a name="l00234"></a>00234 
<a name="l00239"></a><a class="code" href="class_c_p_collection_view.html#af137b1120b91af37820c830a797eafae">00239</a> - (BOOL)isSelected
<a name="l00240"></a>00240 {
<a name="l00241"></a>00241     <span class="keywordflow">return</span> _isSelected;
<a name="l00242"></a>00242 }
<a name="l00243"></a>00243 
<a name="l00248"></a><a class="code" href="class_c_p_collection_view.html#aab9d3db4a695c4e2a0926599b33c9f2a">00248</a> - (void)setAllowsEmptySelection:(BOOL)shouldAllowEmptySelection
<a name="l00249"></a>00249 {
<a name="l00250"></a>00250     _allowsEmptySelection = shouldAllowEmptySelection;
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00256"></a><a class="code" href="class_c_p_collection_view.html#abddcc941958a39048b7eeaee47e2fbde">00256</a> - (BOOL)allowsEmptySelection
<a name="l00257"></a>00257 {
<a name="l00258"></a>00258     <span class="keywordflow">return</span> _allowsEmptySelection;
<a name="l00259"></a>00259 }
<a name="l00260"></a>00260 
<a name="l00265"></a><a class="code" href="class_c_p_collection_view.html#a7a05692675646eb5453af365dcde1146">00265</a> - (void)setAllowsMultipleSelection:(BOOL)shouldAllowMultipleSelection
<a name="l00266"></a>00266 {
<a name="l00267"></a>00267     _allowsMultipleSelection = shouldAllowMultipleSelection;
<a name="l00268"></a>00268 }
<a name="l00269"></a>00269 
<a name="l00273"></a><a class="code" href="class_c_p_collection_view.html#af6c12656fde19404e8af3dddedc47ace">00273</a> - (BOOL)allowsMultipleSelection
<a name="l00274"></a>00274 {
<a name="l00275"></a>00275     <span class="keywordflow">return</span> _allowsMultipleSelection;
<a name="l00276"></a>00276 }
<a name="l00277"></a>00277 
<a name="l00282"></a><a class="code" href="class_c_p_collection_view.html#a6cd83badb27419ed2313bb18ce3e7309">00282</a> - (void)setSelectionIndexes:(<a class="code" href="class_c_p_index_set.html">CPIndexSet</a>)anIndexSet
<a name="l00283"></a>00283 {
<a name="l00284"></a>00284     <span class="keywordflow">if</span> (_selectionIndexes == anIndexSet || !_isSelectable)
<a name="l00285"></a>00285         <span class="keywordflow">return</span>;
<a name="l00286"></a>00286     
<a name="l00287"></a>00287     var index = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l00288"></a>00288     
<a name="l00289"></a>00289     <span class="keywordflow">while</span> ((index = [_selectionIndexes indexGreaterThanIndex:index]) != <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l00290"></a>00290         [_items[index] setSelected:NO];
<a name="l00291"></a>00291     
<a name="l00292"></a>00292     _selectionIndexes = anIndexSet;
<a name="l00293"></a>00293     
<a name="l00294"></a>00294     var index = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l00295"></a>00295     
<a name="l00296"></a>00296     <span class="keywordflow">while</span> ((index = [_selectionIndexes indexGreaterThanIndex:index]) != <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l00297"></a>00297         [_items[index] setSelected:YES];
<a name="l00298"></a>00298     
<a name="l00299"></a>00299     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(collectionViewDidChangeSelection:)])
<a name="l00300"></a>00300         [_delegate collectionViewDidChangeSelection:self]
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00306"></a><a class="code" href="class_c_p_collection_view.html#aae70298047d5235ca4676f2da550aca6">00306</a> - (<a class="code" href="class_c_p_index_set.html">CPIndexSet</a>)selectionIndexes
<a name="l00307"></a>00307 {
<a name="l00308"></a>00308     <span class="keywordflow">return</span> _selectionIndexes;
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">/* @ignore */</span>
<a name="l00312"></a><a class="code" href="class_c_p_collection_view.html#ad49cfac8afb29920f92406655277db69">00312</a> - (void)reloadContent
<a name="l00313"></a>00313 {   
<a name="l00314"></a>00314     <span class="comment">// Remove current views</span>
<a name="l00315"></a>00315     var count = _items.length;
<a name="l00316"></a>00316     
<a name="l00317"></a>00317     <span class="keywordflow">while</span> (count--)
<a name="l00318"></a>00318     {
<a name="l00319"></a>00319         [[_items[count] view] removeFromSuperview];
<a name="l00320"></a>00320         _cachedItems.push(_items[count]);
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322     
<a name="l00323"></a>00323     _items = [];
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <span class="keywordflow">if</span> (!_itemData || !_content)
<a name="l00326"></a>00326         <span class="keywordflow">return</span>;
<a name="l00327"></a>00327     
<a name="l00328"></a>00328     var index = 0;
<a name="l00329"></a>00329     
<a name="l00330"></a>00330     count = _content.length;
<a name="l00331"></a>00331         
<a name="l00332"></a>00332     <span class="keywordflow">for</span> (; index &lt; count; ++index)
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334         _items.push([<span class="keyword">self</span> newItemForRepresentedObject:_content[index]]);
<a name="l00335"></a>00335     
<a name="l00336"></a>00336         [<span class="keyword">self</span> addSubview:[_items[index] view]];
<a name="l00337"></a>00337     }
<a name="l00338"></a>00338     
<a name="l00339"></a>00339     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">tile</a>];
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="comment">/* @ignore */</span>
<a name="l00343"></a><a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">00343</a> - (void)tile
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345     var <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a> = <a class="code" href="_c_g_geometry_8j.html#aa310af239f2108c573299b35776996fa">CGRectGetWidth</a>([<span class="keyword">self</span> bounds]);
<a name="l00346"></a>00346         
<a name="l00347"></a>00347     <span class="keywordflow">if</span> (![_content count] || <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a> == _tileWidth)
<a name="l00348"></a>00348         <span class="keywordflow">return</span>;
<a name="l00349"></a>00349         
<a name="l00350"></a>00350     <span class="comment">// We try to fit as many views per row as possible.  Any remaining space is then </span>
<a name="l00351"></a>00351     <span class="comment">// either proportioned out to the views (if their minSize != maxSize) or used as</span>
<a name="l00352"></a>00352     <span class="comment">// margin</span>
<a name="l00353"></a>00353     var itemSize = <a class="code" href="_c_g_geometry_8j.html#affb0172e44ea288a2660c9a5394db33a">CGSizeMakeCopy</a>(_minItemSize);
<a name="l00354"></a>00354     
<a name="l00355"></a>00355     _numberOfColumns = <a class="code" href="_c_p_obj_j_runtime_8j.html#a45f5f88d061da0c18bcb6b6a854fe898">MAX</a>(1.0, FLOOR(<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a> / itemSize.width));
<a name="l00356"></a>00356     
<a name="l00357"></a>00357     <span class="keywordflow">if</span> (_maxNumberOfColumns &gt; 0)
<a name="l00358"></a>00358         _numberOfColumns = <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(_maxNumberOfColumns, _numberOfColumns);
<a name="l00359"></a>00359             
<a name="l00360"></a>00360     var remaining = <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a> - _numberOfColumns * itemSize.width,
<a name="l00361"></a>00361         itemsNeedSizeUpdate = NO;
<a name="l00362"></a>00362         
<a name="l00363"></a>00363     <span class="keywordflow">if</span> (remaining &gt; 0 &amp;&amp; itemSize.width &lt; _maxItemSize.width)
<a name="l00364"></a>00364         itemSize.width = <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(_maxItemSize.width, itemSize.width + FLOOR(remaining / _numberOfColumns));
<a name="l00365"></a>00365     
<a name="l00366"></a>00366     <span class="comment">// When we ONE column and a non-integral width, the FLOORing above can cause the item width to be smaller than the total width.</span>
<a name="l00367"></a>00367     <span class="keywordflow">if</span> (_maxNumberOfColumns == 1 &amp;&amp; itemSize.width &lt; _maxItemSize.width &amp;&amp; itemSize.width &lt; <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>)
<a name="l00368"></a>00368         itemSize.width = <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(_maxItemSize.width, <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>);
<a name="l00369"></a>00369     
<a name="l00370"></a>00370     <span class="keywordflow">if</span> (!<a class="code" href="_c_g_geometry_8j.html#a1eefbb30f35d5c4f4473bec9a2ebff9f">CGSizeEqualToSize</a>(_itemSize, itemSize))
<a name="l00371"></a>00371     {
<a name="l00372"></a>00372         _itemSize = itemSize;
<a name="l00373"></a>00373         itemsNeedSizeUpdate = YES;
<a name="l00374"></a>00374     }
<a name="l00375"></a>00375     
<a name="l00376"></a>00376     var index = 0,
<a name="l00377"></a>00377         count = _items.length;
<a name="l00378"></a>00378     
<a name="l00379"></a>00379     <span class="keywordflow">if</span> (_maxNumberOfColumns &gt; 0 &amp;&amp; _maxNumberOfRows &gt; 0)
<a name="l00380"></a>00380         count = <a class="code" href="_c_p_obj_j_runtime_8j.html#a4fca277171215842609dc38a6f0c19fb">MIN</a>(count, _maxNumberOfColumns * _maxNumberOfRows);
<a name="l00381"></a>00381     
<a name="l00382"></a>00382     _numberOfRows = CEIL(count / _numberOfColumns);
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     _horizontalMargin = FLOOR((<a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a> - _numberOfColumns * itemSize.width) / (_numberOfColumns + 1));
<a name="l00385"></a>00385         
<a name="l00386"></a>00386     var x = _horizontalMargin,
<a name="l00387"></a>00387         y = -itemSize.height;
<a name="l00388"></a>00388     
<a name="l00389"></a>00389     <span class="keywordflow">for</span> (; index &lt; count; ++index)
<a name="l00390"></a>00390     {
<a name="l00391"></a>00391         <span class="keywordflow">if</span> (index % _numberOfColumns == 0)
<a name="l00392"></a>00392         {
<a name="l00393"></a>00393             x = _horizontalMargin;
<a name="l00394"></a>00394             y += _verticalMargin + itemSize.height;
<a name="l00395"></a>00395         }
<a name="l00396"></a>00396         
<a name="l00397"></a>00397         var view = [_items[index] view];
<a name="l00398"></a>00398         
<a name="l00399"></a>00399         [view setFrameOrigin:CGPointMake(x, y)];
<a name="l00400"></a>00400         
<a name="l00401"></a>00401         <span class="keywordflow">if</span> (itemsNeedSizeUpdate)
<a name="l00402"></a>00402             [view setFrameSize:_itemSize];
<a name="l00403"></a>00403             
<a name="l00404"></a>00404         x += itemSize.width + _horizontalMargin;
<a name="l00405"></a>00405     }
<a name="l00406"></a>00406     
<a name="l00407"></a>00407     _tileWidth = <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>;
<a name="l00408"></a>00408     [<span class="keyword">self</span> setFrameSize:CGSizeMake(width, y + itemSize.height + _verticalMargin)];
<a name="l00409"></a>00409     _tileWidth = -1.0;
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 
<a name="l00412"></a><a class="code" href="class_c_p_collection_view.html#a50ee9ac5e8269a45b6e9d27aadd82dd0">00412</a> - (void)resizeSubviewsWithOldSize:(CGSize)aSize
<a name="l00413"></a>00413 {
<a name="l00414"></a>00414     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">tile</a>];
<a name="l00415"></a>00415 }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="comment">// Laying Out the Collection View</span>
<a name="l00422"></a><a class="code" href="class_c_p_collection_view.html#af8fd79b183363119d0873f302f35a9df">00422</a> <span class="comment"></span>- (void)setMaxNumberOfRows:(<span class="keywordtype">unsigned</span>)aMaxNumberOfRows
<a name="l00423"></a>00423 {
<a name="l00424"></a>00424     <span class="keywordflow">if</span> (_maxNumberOfRows == aMaxNumberOfRows)
<a name="l00425"></a>00425         <span class="keywordflow">return</span>;
<a name="l00426"></a>00426     
<a name="l00427"></a>00427     _maxNumberOfRows = aMaxNumberOfRows;
<a name="l00428"></a>00428     
<a name="l00429"></a>00429     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">tile</a>];
<a name="l00430"></a>00430 }
<a name="l00431"></a>00431 
<a name="l00435"></a><a class="code" href="class_c_p_collection_view.html#aa48096d62b781aa786af06f3e2daa1d3">00435</a> - (unsigned)maxNumberOfRows
<a name="l00436"></a>00436 {
<a name="l00437"></a>00437     <span class="keywordflow">return</span> _maxNumberOfRows;
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00444"></a><a class="code" href="class_c_p_collection_view.html#affd252171f1b74aa0705ee7702172970">00444</a> - (void)setMaxNumberOfColumns:(<span class="keywordtype">unsigned</span>)aMaxNumberOfColumns
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446     <span class="keywordflow">if</span> (_maxNumberOfColumns == aMaxNumberOfColumns)
<a name="l00447"></a>00447         <span class="keywordflow">return</span>;
<a name="l00448"></a>00448     
<a name="l00449"></a>00449     _maxNumberOfColumns = aMaxNumberOfColumns;
<a name="l00450"></a>00450     
<a name="l00451"></a>00451     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">tile</a>];
<a name="l00452"></a>00452 }
<a name="l00453"></a>00453 
<a name="l00457"></a><a class="code" href="class_c_p_collection_view.html#a160c36ef0dcd30a934e74d46adc4cf27">00457</a> - (unsigned)maxNumberOfColumns
<a name="l00458"></a>00458 {
<a name="l00459"></a>00459     <span class="keywordflow">return</span> _maxNumberOfColumns;
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00465"></a><a class="code" href="class_c_p_collection_view.html#ae43303f7e5e65fde1d1a56eedfb722b1">00465</a> - (unsigned)numberOfRows
<a name="l00466"></a>00466 {
<a name="l00467"></a>00467     <span class="keywordflow">return</span> _numberOfRows;
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00474"></a><a class="code" href="class_c_p_collection_view.html#ae2714ba37cd54a1c2cd6eccc448d8895">00474</a> - (unsigned)numberOfColumns
<a name="l00475"></a>00475 {
<a name="l00476"></a>00476     <span class="keywordflow">return</span> _numberOfColumns;
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00483"></a><a class="code" href="class_c_p_collection_view.html#aa6fb4439ea0c5f770bd2d07c72ba7d4d">00483</a> - (void)setMinItemSize:(CGSize)aSize
<a name="l00484"></a>00484 {
<a name="l00485"></a>00485     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a1eefbb30f35d5c4f4473bec9a2ebff9f">CGSizeEqualToSize</a>(_minItemSize, aSize))
<a name="l00486"></a>00486         <span class="keywordflow">return</span>;
<a name="l00487"></a>00487     
<a name="l00488"></a>00488     _minItemSize = <a class="code" href="_c_g_geometry_8j.html#affb0172e44ea288a2660c9a5394db33a">CGSizeMakeCopy</a>(aSize);
<a name="l00489"></a>00489     
<a name="l00490"></a>00490     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">tile</a>];
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00496"></a><a class="code" href="class_c_p_collection_view.html#ad37322c84501e2d6c1c61280cc682ab9">00496</a> - (CGSize)minItemSize
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498     <span class="keywordflow">return</span> _minItemSize;
<a name="l00499"></a>00499 }
<a name="l00500"></a>00500 
<a name="l00505"></a><a class="code" href="class_c_p_collection_view.html#a3a42a795d801ca62c33df2c818beeb2a">00505</a> - (void)setMaxItemSize:(CGSize)aSize
<a name="l00506"></a>00506 {
<a name="l00507"></a>00507     <span class="keywordflow">if</span> (<a class="code" href="_c_g_geometry_8j.html#a1eefbb30f35d5c4f4473bec9a2ebff9f">CGSizeEqualToSize</a>(_maxItemSize, aSize))
<a name="l00508"></a>00508         <span class="keywordflow">return</span>;
<a name="l00509"></a>00509     
<a name="l00510"></a>00510     _maxItemSize = <a class="code" href="_c_g_geometry_8j.html#affb0172e44ea288a2660c9a5394db33a">CGSizeMakeCopy</a>(aSize);
<a name="l00511"></a>00511     
<a name="l00512"></a>00512     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">tile</a>];
<a name="l00513"></a>00513 }
<a name="l00514"></a>00514 
<a name="l00518"></a><a class="code" href="class_c_p_collection_view.html#a8d578518fad22d4b4e9c9e49407b1ed3">00518</a> - (CGSize)maxItemSize
<a name="l00519"></a>00519 {
<a name="l00520"></a>00520     <span class="keywordflow">return</span> _maxItemSize;
<a name="l00521"></a>00521 }
<a name="l00522"></a>00522 
<a name="l00523"></a><a class="code" href="class_c_p_collection_view.html#a938725cc831c1b5675b7d6f923bc26d4">00523</a> - (void)mouseUp:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent
<a name="l00524"></a>00524 {
<a name="l00525"></a>00525     <span class="keywordflow">if</span> ([_selectionIndexes count] &amp;&amp; [anEvent clickCount] == 2 &amp;&amp; [_delegate respondsToSelector:<span class="keyword">@selector</span>(collectionView:didDoubleClickOnItemAtIndex:)])
<a name="l00526"></a>00526         [_delegate collectionView:self didDoubleClickOnItemAtIndex:[_selectionIndexes firstIndex]];
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00529"></a><a class="code" href="class_c_p_collection_view.html#a5b862319380fa8f99c77cbd621d8ffce">00529</a> - (void)mouseDown:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent
<a name="l00530"></a>00530 {
<a name="l00531"></a>00531     var location = [<span class="keyword">self</span> convertPoint:[anEvent <a class="code" href="class_c_p_event.html#a5a57f4fa909de5d83e5402a8d8af4b94">locationInWindow</a>] fromView:nil],
<a name="l00532"></a>00532         row = FLOOR(location.y / (_itemSize.height + _verticalMargin)),
<a name="l00533"></a>00533         column = FLOOR(location.x / (_itemSize.width + _horizontalMargin)),
<a name="l00534"></a>00534         index = row * _numberOfColumns + column;
<a name="l00535"></a>00535         
<a name="l00536"></a>00536     <span class="keywordflow">if</span> (index &gt;= 0 &amp;&amp; index &lt; _items.length)
<a name="l00537"></a>00537         [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a6cd83badb27419ed2313bb18ce3e7309">setSelectionIndexes</a>:[<a class="code" href="class_c_p_index_set.html">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:index]];
<a name="l00538"></a>00538     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_allowsEmptySelection)
<a name="l00539"></a>00539         [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a6cd83badb27419ed2313bb18ce3e7309">setSelectionIndexes</a>:[<a class="code" href="class_c_p_index_set.html">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>]];
<a name="l00540"></a>00540 }
<a name="l00541"></a>00541 
<a name="l00542"></a><a class="code" href="class_c_p_collection_view.html#aaea497acf4cb4cfc0162acedca8f4631">00542</a> - (void)mouseDragged:(<a class="code" href="class_c_p_event.html">CPEvent</a>)anEvent
<a name="l00543"></a>00543 {
<a name="l00544"></a>00544     <span class="keywordflow">if</span> (![_delegate respondsToSelector:<span class="keyword">@selector</span>(collectionView:dragTypesForItemsAtIndexes:)])
<a name="l00545"></a>00545         <span class="keywordflow">return</span>;
<a name="l00546"></a>00546         
<a name="l00547"></a>00547     <span class="comment">// If we don&apos;t have any selected items, we&apos;ve clicked away, and thus the drag is meaningless.</span>
<a name="l00548"></a>00548     <span class="keywordflow">if</span> (![_selectionIndexes count])
<a name="l00549"></a>00549         <span class="keywordflow">return</span>;
<a name="l00550"></a>00550         
<a name="l00551"></a>00551     <span class="comment">// Set up the pasteboard</span>
<a name="l00552"></a>00552     var dragTypes = [_delegate collectionView:self dragTypesForItemsAtIndexes:_selectionIndexes];
<a name="l00553"></a>00553     
<a name="l00554"></a>00554     [[<a class="code" href="class_c_p_pasteboard.html">CPPasteboard</a> <a class="code" href="class_c_p_pasteboard.html#adc671279bc4d0608ebe421e4657ecd07">pasteboardWithName</a>:CPDragPboard] <a class="code" href="class_c_p_pasteboard.html#a64b3f3c2088412a6577c1905bb758f8e">declareTypes</a>:dragTypes <a class="code" href="class_c_p_pasteboard.html#a64b3f3c2088412a6577c1905bb758f8e">owner</a>:self];
<a name="l00555"></a>00555     
<a name="l00556"></a>00556     var point = [<span class="keyword">self</span> convertPoint:[anEvent <a class="code" href="class_c_p_event.html#a5a57f4fa909de5d83e5402a8d8af4b94">locationInWindow</a>] fromView:nil];
<a name="l00557"></a>00557 
<a name="l00558"></a>00558     [_itemForDragging setRepresentedObject:_content[[_selectionIndexes firstIndex]]];
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     var view = [_itemForDragging view],
<a name="l00561"></a>00561         <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a> = [view frame];
<a name="l00562"></a>00562     
<a name="l00563"></a>00563     [view setFrameSize:_itemSize];
<a name="l00564"></a>00564     [view setAlphaValue:0.7];
<a name="l00565"></a>00565     
<a name="l00566"></a>00566     [<span class="keyword">self</span> dragView:view
<a name="l00567"></a>00567         at:[[_items[[_selectionIndexes firstIndex]] view] frame].origin
<a name="l00568"></a>00568         offset:CGPointMakeZero()
<a name="l00569"></a>00569         event:anEvent
<a name="l00570"></a>00570         pasteboard:nil
<a name="l00571"></a>00571         source:self
<a name="l00572"></a>00572         slideBack:YES];
<a name="l00573"></a>00573 }
<a name="l00574"></a>00574 
<a name="l00580"></a><a class="code" href="class_c_p_collection_view.html#a8c186a2c3339ca293e6846bd13754c2d">00580</a> - (void)pasteboard:(<a class="code" href="class_c_p_pasteboard.html">CPPasteboard</a>)aPasteboard provideDataForType:(<a class="code" href="class_c_p_string.html">CPString</a>)aType
<a name="l00581"></a>00581 {
<a name="l00582"></a>00582     [aPasteboard <a class="code" href="class_c_p_pasteboard.html#a0f4cce5a1bd580066621bd0bd9884cae">setData</a>:[_delegate collectionView:self dataForItemsAtIndexes:_selectionIndexes forType:aType] <a class="code" href="class_c_p_pasteboard.html#a0f4cce5a1bd580066621bd0bd9884cae">forType</a>:aType];
<a name="l00583"></a>00583 }
<a name="l00584"></a>00584 
<a name="l00585"></a>00585 <span class="comment">// Cappuccino Additions</span>
<a name="l00586"></a>00586 
<a name="l00592"></a><a class="code" href="class_c_p_collection_view.html#a5f8e8ee51777ed47e70c1898b96c20f7">00592</a> - (void)setVerticalMargin:(<span class="keywordtype">float</span>)aVerticalMargin
<a name="l00593"></a>00593 {
<a name="l00594"></a>00594     <span class="keywordflow">if</span> (_verticalMargin == aVerticalMargin)
<a name="l00595"></a>00595         <span class="keywordflow">return</span>;
<a name="l00596"></a>00596     
<a name="l00597"></a>00597     _verticalMargin = aVerticalMargin;
<a name="l00598"></a>00598     
<a name="l00599"></a>00599     [<span class="keyword">self</span> <a class="code" href="class_c_p_collection_view.html#a47804ebf6cd4f21fdf793511f56d9549">tile</a>];
<a name="l00600"></a>00600 }
<a name="l00601"></a>00601 
<a name="l00606"></a><a class="code" href="class_c_p_collection_view.html#aec1daa99dd9ee30f87301540c5e13388">00606</a> - (float)verticalMargin
<a name="l00607"></a>00607 {
<a name="l00608"></a>00608     <span class="keywordflow">return</span> _verticalMargin;
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00615"></a><a class="code" href="class_c_p_collection_view.html#ab63381d049a6a9890322f73f4289d275">00615</a> - (void)setDelegate:(<span class="keywordtype">id</span>)aDelegate
<a name="l00616"></a>00616 {
<a name="l00617"></a>00617     _delegate = aDelegate;
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00623"></a><a class="code" href="class_c_p_collection_view.html#acb2e8595f456112618ad0c1a77514d01">00623</a> - (id)delegate
<a name="l00624"></a>00624 {
<a name="l00625"></a>00625     <span class="keywordflow">return</span> _delegate;
<a name="l00626"></a>00626 }
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 <span class="keyword">@end</span>
<a name="l00629"></a>00629 
<a name="l00633"></a><a class="code" href="class_c_p_collection_view_item.html">00633</a> <span class="keyword">@implementation </span><a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a> : <a class="code" href="class_c_p_object.html">CPObject</a>
<a name="l00634"></a>00634 {
<a name="l00635"></a>00635     <span class="keywordtype">id</span>      _representedObject;
<a name="l00636"></a>00636     
<a name="l00637"></a>00637     <a class="code" href="class_c_p_view.html">CPView</a>  _view;
<a name="l00638"></a>00638     
<a name="l00639"></a>00639     BOOL    _isSelected;
<a name="l00640"></a>00640 }
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 <span class="comment">// Setting the Represented Object</span>
<a name="l00647"></a><a class="code" href="class_c_p_collection_view_item.html#a5e531b308426584e710eaabda58a758f">00647</a> <span class="comment"></span>- (void)setRepresentedObject:(<span class="keywordtype">id</span>)anObject
<a name="l00648"></a>00648 {
<a name="l00649"></a>00649     <span class="keywordflow">if</span> (_representedObject == anObject)
<a name="l00650"></a>00650         <span class="keywordflow">return</span>;
<a name="l00651"></a>00651     
<a name="l00652"></a>00652     _representedObject = anObject;
<a name="l00653"></a>00653     
<a name="l00654"></a>00654     <span class="comment">// FIXME: This should be set up by bindings</span>
<a name="l00655"></a>00655     [_view setRepresentedObject:anObject];
<a name="l00656"></a>00656 }
<a name="l00657"></a>00657 
<a name="l00661"></a><a class="code" href="class_c_p_collection_view_item.html#a4af2de602b69d21f0aed59da54ba6a04">00661</a> - (id)representedObject
<a name="l00662"></a>00662 {
<a name="l00663"></a>00663     <span class="keywordflow">return</span> _representedObject;
<a name="l00664"></a>00664 }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666 <span class="comment">// Modifying the View</span>
<a name="l00671"></a><a class="code" href="class_c_p_collection_view_item.html#a55f1f6db2bf67154d70b4a686f884694">00671</a> <span class="comment"></span>- (void)setView:(<a class="code" href="class_c_p_view.html">CPView</a>)aView
<a name="l00672"></a>00672 {
<a name="l00673"></a>00673     _view = aView;
<a name="l00674"></a>00674 }
<a name="l00675"></a>00675 
<a name="l00679"></a><a class="code" href="class_c_p_collection_view_item.html#a772dfa13d198cfc742996d27355493b6">00679</a> - (<a class="code" href="class_c_p_view.html">CPView</a>)view
<a name="l00680"></a>00680 {
<a name="l00681"></a>00681     <span class="keywordflow">return</span> _view;
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 <span class="comment">// Modifying the Selection</span>
<a name="l00689"></a><a class="code" href="class_c_p_collection_view_item.html#a18305548f8a965b42fc7e5556ae10a08">00689</a> <span class="comment"></span>- (void)setSelected:(BOOL)shouldBeSelected
<a name="l00690"></a>00690 {
<a name="l00691"></a>00691     <span class="keywordflow">if</span> (_isSelected == shouldBeSelected)
<a name="l00692"></a>00692         <span class="keywordflow">return</span>;
<a name="l00693"></a>00693     
<a name="l00694"></a>00694     _isSelected = shouldBeSelected;
<a name="l00695"></a>00695     
<a name="l00696"></a>00696     <span class="comment">// FIXME: This should be set up by bindings</span>
<a name="l00697"></a>00697     [_view setSelected:_isSelected];
<a name="l00698"></a>00698 }
<a name="l00699"></a>00699 
<a name="l00703"></a><a class="code" href="class_c_p_collection_view_item.html#a48e1436f47c6b9880472a31e2a7364bc">00703</a> - (BOOL)isSelected
<a name="l00704"></a>00704 {
<a name="l00705"></a>00705     <span class="keywordflow">return</span> _isSelected;
<a name="l00706"></a>00706 }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 <span class="comment">// Parent Collection View</span>
<a name="l00712"></a><a class="code" href="class_c_p_collection_view_item.html#aab8419009b605e1324d78d68cd1c9a54">00712</a> <span class="comment"></span>- (<a class="code" href="class_c_p_collection_view.html">CPCollectionView</a>)collectionView
<a name="l00713"></a>00713 {
<a name="l00714"></a>00714     <span class="keywordflow">return</span> [_view superview];
<a name="l00715"></a>00715 }
<a name="l00716"></a>00716 
<a name="l00717"></a>00717 <span class="keyword">@end</span>
<a name="l00718"></a>00718 
<a name="l00719"></a><a class="code" href="_c_p_collection_view_8j.html#a441f38bb0b93ea62e27bd64e878b7b8c">00719</a> var <a class="code" href="_c_p_collection_view_8j.html#a441f38bb0b93ea62e27bd64e878b7b8c">CPCollectionViewMinItemSizeKey</a>      = <span class="stringliteral">@&quot;CPCollectionViewMinItemSizeKey&quot;</span>,
<a name="l00720"></a><a class="code" href="_c_p_collection_view_8j.html#a2a34f079aaa3baf03b3eff47e86ed820">00720</a>     <a class="code" href="_c_p_collection_view_8j.html#a2a34f079aaa3baf03b3eff47e86ed820">CPCollectionViewMaxItemSizeKey</a>      = <span class="stringliteral">@&quot;CPCollectionViewMaxItemSizeKey&quot;</span>,
<a name="l00721"></a><a class="code" href="_c_p_collection_view_8j.html#a5fb05760157ca2a6150194f015684fb1">00721</a>     <a class="code" href="_c_p_collection_view_8j.html#a5fb05760157ca2a6150194f015684fb1">CPCollectionViewVerticalMarginKey</a>   = <span class="stringliteral">@&quot;CPCollectionViewVerticalMarginKey&quot;</span>;
<a name="l00722"></a>00722 
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="keyword">@implementation </span><a class="code" href="class_c_p_collection_view.html">CPCollectionView</a> (CPCoding)
<a name="l00725"></a>00725 
<a name="l00726"></a><a class="code" href="class_c_p_collection_view.html#ad56279e2d4d3f17bda8ddcdef7f434e2">00726</a> - (id)initWithCoder:(<a class="code" href="class_c_p_coder.html">CPCoder</a>)aCoder
<a name="l00727"></a>00727 {
<a name="l00728"></a>00728     <span class="keyword">self</span> = [<span class="keyword">super</span> initWithCoder:aCoder];
<a name="l00729"></a>00729 
<a name="l00730"></a>00730     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l00731"></a>00731     {
<a name="l00732"></a>00732         _items = [];
<a name="l00733"></a>00733         _content = [];
<a name="l00734"></a>00734 
<a name="l00735"></a>00735         _cachedItems = [];
<a name="l00736"></a>00736 
<a name="l00737"></a>00737         _itemSize = <a class="code" href="_c_g_geometry_8j.html#ab8e35bab228754c325f263092a141847">CGSizeMakeZero</a>();
<a name="l00738"></a>00738         _minItemSize = [aCoder decodeSizeForKey:CPCollectionViewMinItemSizeKey];
<a name="l00739"></a>00739         _maxItemSize = [aCoder decodeSizeForKey:CPCollectionViewMaxItemSizeKey];
<a name="l00740"></a>00740 
<a name="l00741"></a>00741         _verticalMargin = [aCoder decodeSizeForKey:CPCollectionViewVerticalMarginKey];
<a name="l00742"></a>00742         _tileWidth = -1.0;
<a name="l00743"></a>00743 
<a name="l00744"></a>00744         _selectionIndexes = [<a class="code" href="class_c_p_index_set.html">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l00748"></a>00748 }
<a name="l00749"></a>00749 
<a name="l00750"></a><a class="code" href="class_c_p_collection_view.html#a0271a2cb71920c794a1a136ce8af7553">00750</a> - (void)encodeWithCoder:(<a class="code" href="class_c_p_coder.html">CPCoder</a>)aCoder
<a name="l00751"></a>00751 {
<a name="l00752"></a>00752     [<span class="keyword">super</span> encodeWithCoder:aCoder];
<a name="l00753"></a>00753 
<a name="l00754"></a>00754     [aCoder encodeSize:_minItemSize forKey:CPCollectionViewMinItemSizeKey];
<a name="l00755"></a>00755     [aCoder encodeSize:_maxItemSize forKey:CPCollectionViewMaxItemSizeKey];
<a name="l00756"></a>00756 
<a name="l00757"></a>00757     [aCoder encodeSize:_verticalMargin forKey:CPCollectionViewVerticalMarginKey];
<a name="l00758"></a>00758 }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760 <span class="keyword">@end</span>
<a name="l00761"></a>00761 
<a name="l00762"></a><a class="code" href="_c_p_collection_view_8j.html#a77268710a9993d16519f516f42d8a80e">00762</a> var <a class="code" href="_c_p_collection_view_8j.html#a77268710a9993d16519f516f42d8a80e">CPCollectionViewItemViewKey</a> = <span class="stringliteral">@&quot;CPCollectionViewItemViewKey&quot;</span>;
<a name="l00763"></a>00763 
<a name="l00764"></a>00764 <span class="keyword">@implementation </span><a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a> (CPCoding)
<a name="l00765"></a>00765 
<a name="l00766"></a>00766 <span class="comment">/*</span>
<a name="l00767"></a>00767 <span class="comment">    FIXME Not yet implemented</span>
<a name="l00768"></a>00768 <span class="comment">*/</span>
<a name="l00769"></a><a class="code" href="class_c_p_collection_view_item.html#a62701d1029970c50faab98f876b183c5">00769</a> - (id)<a class="code" href="class_c_p_collection_view_item.html#a62701d1029970c50faab98f876b183c5">copy</a>
<a name="l00770"></a>00770 {
<a name="l00771"></a>00771     
<a name="l00772"></a>00772 }
<a name="l00773"></a>00773 
<a name="l00774"></a>00774 <span class="keyword">@end</span>
<a name="l00775"></a>00775 
<a name="l00776"></a>00776 var <a class="code" href="_c_p_collection_view_8j.html#a77268710a9993d16519f516f42d8a80e">CPCollectionViewItemViewKey</a> = <span class="stringliteral">@&quot;CPCollectionViewItemViewKey&quot;</span>;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 <span class="keyword">@implementation </span><a class="code" href="class_c_p_collection_view_item.html">CPCollectionViewItem</a> (CPCoding)
<a name="l00779"></a>00779 
<a name="l00785"></a><a class="code" href="class_c_p_collection_view_item.html#aa971010ec4dbeecf980809aa3d8ab9d5">00785</a> - (id)initWithCoder:(<a class="code" href="class_c_p_coder.html">CPCoder</a>)aCoder
<a name="l00786"></a>00786 {
<a name="l00787"></a>00787     <span class="keyword">self</span> = [<span class="keyword">super</span> init];
<a name="l00788"></a>00788     
<a name="l00789"></a>00789     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l00790"></a>00790         _view = [aCoder decodeObjectForKey:CPCollectionViewItemViewKey];
<a name="l00791"></a>00791     
<a name="l00792"></a>00792     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l00793"></a>00793 }
<a name="l00794"></a>00794 
<a name="l00799"></a><a class="code" href="class_c_p_collection_view_item.html#a679329ec587a1f1730fcba90000dfbb1">00799</a> - (void)encodeWithCoder:(<a class="code" href="class_c_p_coder.html">CPCoder</a>)aCoder
<a name="l00800"></a>00800 {
<a name="l00801"></a>00801     [aCoder encodeObject:_view forKey:CPCollectionViewItemViewKey];
<a name="l00802"></a>00802 }
<a name="l00803"></a>00803 
<a name="l00804"></a>00804 <span class="keyword">@end</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0,'all')"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1,'classes')"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2,'files')"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3,'functions')"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4,'variables')"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5,'defines')"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<a href="javascript:searchBox.CloseResultsWindow()" 
   id="MSearchResultsWindowClose"
   onmouseover="return searchBox.OnCloseHighlight(true)"
   onmouseout="return searchBox.OnCloseHighlight(false)"><img border="0" src="search/close.png" alt=""/></a>
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Sun Jul 5 21:41:27 2009 for Cappuccino by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.5.9-20090622 </small></address>
</body>
</html>
